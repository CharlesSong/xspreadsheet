{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/local/base/element.ts","webpack:///./src/local/base/icon.ts","webpack:///./src/local/event.ts","webpack:///./src/core/cell.ts","webpack:///./src/core/alphabet.ts","webpack:///./src/core/formula.ts","webpack:///./src/core/format.ts","webpack:///./src/local/editorbar.ts","webpack:///./src/local/base/colorPanel.ts","webpack:///./src/local/base/menu.ts","webpack:///./src/local/base/dropdown.ts","webpack:///./src/local/base/item.ts","webpack:///./src/local/toolbar.ts","webpack:///./src/local/resizer.ts","webpack:///./src/local/selector.ts","webpack:///./src/local/editor.ts","webpack:///./src/local/table.ts","webpack:///./node_modules/style-loader/lib/urls.js","webpack:///./node_modules/style-loader/lib/addStyles.js","webpack:///./src/assets/sprite.svg","webpack:///./node_modules/css-loader/lib/css-base.js","webpack:///./node_modules/css-loader/lib/url/escape.js","webpack:///./src/style/index.less","webpack:///./src/style/index.less?de79","webpack:///./src/core/select.ts","webpack:///./src/core/font.ts","webpack:///./src/core/index.ts","webpack:///./src/local/index.ts","webpack:///./src/main.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","Element","[object Object]","tag","this","_data","el","document","createElement","key","undefined","eventName","handler","first","others","split","addEventListener","evt","k","button","stopPropagation","className","map","keys","attr","getAttribute","setAttribute","removeAttribute","offsetTop","offsetLeft","offsetHeight","offsetWidth","top","left","height","width","style","isClear","clearStyle","getPropertyValue","setProperty","removeProperty","cs","child","appendChild","createTextNode","HTMLElement","html","innerHTML","v","cloneNode","isHide","show","hide","addClass","removeClass","flag","deactive","hasClass","cls","concat","join","filter","indexOf","isRemove","removeStyle","h","element_1","Icon","super","class","img","buildIcon","bind","fn","target","window","unbind","removeEventListener","mouseMoveUp","movefunc","upfunc","up","defaultCell","font","format","fontSize","bold","italic","underline","color","backgroundColor","align","valign","wordWrap","invisible","rowspan","colspan","text","getStyleFromCell","cell","_alphabet","alphabet","index","a","b","parseInt","length","alphabetIndex","ret","cindex","charCodeAt","alphabet_1","formulaFilterKey","fx","substring","formula","formulas","toLowerCase","formulaRender","renderCell","param","render","formulaParamToArray","formulaReplaceParam","rowDiff","colDiff","params","replaceFormula","_v","idx","exec","vc","vr","paramValues","min","max","maxIdx","minC","minR","maxC","maxR","push","e","console","log","title","vv","reduce","Number","Math","formatRenderHtml","txt","formats","formatNumberRender","test","parts","toFixed","toString","replace","formatRender","label","Editorbar","change","children","textarea","on","input","setValue","val","colorss","ColorPanel","click","colors","buildColorPanel","Menu","buildMenu","icon_1","Dropdown","contentChildren","content","toggleHandler","contains","data","clickoutsize","documentHandler","active","setTimeout","buildDropdown","Item","iconEl","buildItem","item_1","dropdown_1","menu_1","colorPanel_1","Toolbar","ss","currentCell","redo","undo","elUndo","buildUndo","elRedo","buildRedo","elPaintformat","buildPaintformat","elClearformat","buildClearformat","elFormat","buildFormats","buildSeparator","elFont","buildFonts","elFontSize","buildFontSizes","elFontWeight","buildFontWeight","elFontStyle","buildFontStyle","elTextDecoration","buildTextDecoration","elColor","buildColor","elBackgroundColor","buildBackgroundColor","elMerge","buildMerge","elAlign","buildAligns","elValign","buildValigns","elWordWrap","buildWordWrap","setCell","setCellStyle","getFormat","getFont","able","disabled","titleIcon","clickHandler","it","buildIconItem","is","styles","border-bottom","margin-top","fonts","iconName","isActive","event_1","Resizer","vertical","moving","resizer","mousedown","resizerLine","parentNode","nextSibling","startEvt","distance","buttons","x","offset","y","Selector","table","_offset","changeCopy","arrow","startRow","startCol","stopRow","stopCol","topEl","rightEl","bottomEl","leftEl","areaEl","cornerEl","cornerMousedown","copyEl","keydown","detail","shiftKey","endTarget","setOffset","assign","startTarget","keyCode","select","stop","start","boxRange","rowIndex","colIndex","rdiff","cdiff","_rdiff","_cdiff","rowsHeight","rowLen","abs","colsWidth","colLen","w","minRow","minCol","maxRow","maxCol","_forEach","firsttds","ths","buildSelect","td","cb","elements","es","forEach","DashedSelector","selector","cell_1","Editor","defaultRowHeight","editor","inputChange","textline","visibility","overflow","position","setSelectionRange","focus","reload","setStyle","attrs","ow","maxWidth","documentElement","clientWidth","editor_1","selector_1","resizer_1","format_1","formula_1","Table","bodyHeightFn","cols","tds","fixedLeftBody","state","currentIndexs","editorChange","clickCell","rindex","rowResizer","changeRowResizer","colResizer","changeColResizer","selectorChange","selectorChangeCopy","dashedSelector","bodyHeight","clientHeight","buildFixedLeft","header","buildHeader","buildBody","ctrlKey","copy","returnValue","cut","paste","cellText","autoWordWrap","setTdStyles","setRowHeight","cellAttr","setTdWithCell","setTdStylesAndAttrsAndText","setTdAttrs","set","clearformat","removeAttr","merge","batchPaste","_renderCell","getCell","tdRowspan","changeRowHeight","row","firstTds","col","defaultColWidth","lastColWidth","rows","firstTd","firsttdsPush","thead","th","buildColGroup","editorValue","oldCell","_rindex","_cindex","_cell","clear","cCell","dblclick","tbody","scrollLeft","scrollTop","css","location","Error","baseUrl","protocol","host","currentDir","pathname","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","$1","JSON","stringify","memo","stylesInDom","isOldIE","all","atob","apply","arguments","getElement","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","options","item","domStyle","id","refs","j","addStyle","listToStyles","list","newStyles","base","part","media","sourceMap","insertStyleElement","insertInto","lastStyleElementInsertedAtTop","insertAt","insertBefore","firstChild","before","removeStyleElement","removeChild","splice","createStyleElement","type","addAttrs","obj","update","remove","result","transform","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","btoa","link","rel","createLinkElement","autoFixUrls","convertToAbsoluteUrls","unescape","encodeURIComponent","blob","oldSrc","href","styleSheet","cssText","newObj","DEBUG","newList","mayRemove","textStore","replaceText","replacement","Boolean","cssNode","childNodes","useSourceMap","cssMapping","sourceMapping","sourceURLs","sources","source","sourceRoot","cssWithMappingToString","mediaQuery","alreadyImportedModules","url","slice","escape","hmr","locals","Select","canMerge","sx","sy","ex","ey","font_1","select_1","History","values","oldValue","Spreadsheet","histories","histories2","currentCellIndexes","copySelect","cutSelect","rowHeight","colWidth","prop","startAttrs","getElementAttrs","endAttrs","sRow","sCol","eRow","eCol","calcMinï¼­axRow","calcMinMaxCol","minr","maxr","minc","maxc","firstCell","canotMerge","cselect","history","srcRowIndex","srcColIndex","newCell","copyCell","add","destRowIndex","destColIndex","seqCopy","oldDestCell","destCell","srcCell","m1","m2","pop","resetByHistory","isRedo","isUndo","nValue","mapFilter","ok","cancel","other","cellLen","firstXY","isDefault","indexes","isCopy","cells","mapMaxKey","range","cCol","dcell","cColspan","cRow","cRowspan","index_1","table_1","toolbar_1","editorbar_1","LocalSpreadsheet","editorbar","editorbarChange","toolbar","toolbarChange","setRedoAble","setUndoAble","setCellAttr","copyformat","setValueWithText","xspreadsheet","default"],"mappings":"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","file":"xspreadsheet.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 28);\n","export class Element {\n  el: HTMLElement;\n  _data: {[key: string]: any} = {};\n\n  constructor (public tag = 'div') {\n    this.el = document.createElement(tag)\n  }\n\n  data (key: string, value?: any) {\n    if (value !== undefined) {\n      this._data[key] = value\n    }\n    return this._data[key]\n  }\n\n  on (eventName: string, handler: (evt: any) => any): Element {\n    const [first, ...others] = eventName.split('.')\n    this.el.addEventListener(first, (evt: any) => {\n      for (let k of others) {\n        if (k === 'left' && evt.button !== 1) {\n          return\n        } else if (k === 'right' && evt.button !== 2) {\n          return\n        } else if (k === 'stop') {\n          evt.stopPropagation()\n        }\n      }\n      handler(evt)\n    })\n    return this;\n  }\n\n  class (name: string): Element {\n    this.el.className = name\n    return this;\n  }\n\n  attrs (map: {[key: string]: string} = {}): Element {\n    for (let key of Object.keys(map))\n      this.attr(key, map[key]);\n    return this;\n  }\n\n  attr (attr: string, value?: any): any {\n    if (value !== undefined) {\n      this.el.setAttribute(attr, value);\n    } else {\n      return this.el.getAttribute(attr)\n    }\n    return this;\n  }\n  removeAttr(attr: string): Element {\n    this.el.removeAttribute(attr);\n    return this;\n  }\n\n  offset (): any {\n    const { offsetTop, offsetLeft, offsetHeight, offsetWidth } = this.el\n    return {top: offsetTop, left: offsetLeft, height: offsetHeight, width: offsetWidth}\n  }\n\n  clearStyle () {\n    (<any>this.el).style = ''\n    return this;\n  }\n\n  styles (map: {[key: string]: string} = {}, isClear = false): Element {\n    if (isClear) {\n      this.clearStyle()\n    }\n    for (let key of Object.keys(map))\n      this.style(key, map[key]);\n    return this;\n  }\n\n  style (key: string, value?: any): any {\n    if (value !== undefined) {\n      this.el.style.setProperty(key, value);\n    } else {\n      return this.el.style.getPropertyValue(key)\n    }\n    return this;\n  }\n\n  removeStyle (key: string) {\n    this.el.style.removeProperty(key)\n    return ;\n  }\n\n  children (cs: Array<HTMLElement | string | Element>): Element {\n    for (let c of cs)\n      this.child(c);\n    return this;\n  }\n\n  child (c: HTMLElement | string | Element): Element {\n    if (typeof c === 'string') {\n      this.el.appendChild(document.createTextNode(c))\n    } else if (c instanceof Element) {\n      this.el.appendChild(c.el)\n    } else if (c instanceof HTMLElement) {\n      this.el.appendChild(c)\n    }\n    return this;\n  }\n\n  html (html?: string) {\n    if (html !== undefined) {\n      this.el.innerHTML = html\n    } else {\n      return this.el.innerHTML\n    }\n    return this;\n  }\n\n  val (v?: string) {\n    if (v !== undefined) {\n      // (<any>this.el).value = v\n      (<any>this.el).value = v\n    } else {\n      return (<any>this.el).value\n    }\n    return this;\n  }\n\n  clone (): any {\n    return this.el.cloneNode();\n  }\n\n  isHide () {\n    return this.style('display') === 'none'\n  }\n\n  toggle () {\n    if (this.isHide()) {\n      this.show()\n    } else {\n      this.hide()\n    }\n  }\n\n  disabled (): Element {\n    // this.removeClass('disabled')\n    this.addClass('disabled')\n    return this;\n  }\n  able (): Element {\n    this.removeClass('disabled')\n    return this;\n  }\n\n  active (flag = true): Element {\n    // this.el.className = this.el.className.split(' ').filter(c => c !== 'disabled').join(' ') + ' active'\n    // this.removeClass('disabled')\n    if (flag)\n      this.addClass('active')\n    else\n      this.deactive()\n    return this;\n  }\n  deactive (): Element {\n    return this.removeClass('active')\n  }\n  isActive (): boolean {\n    return this.hasClass('active');\n  }\n\n  addClass (cls: string): Element {\n    this.el.className = this.el.className.split(' ').concat(cls).join(' ')\n    return this;\n  }\n  removeClass (cls: string) {\n    // console.log('before.className: ', this.el.className)\n    this.el.className = this.el.className.split(' ').filter(c => c !== cls).join(' ')\n    // console.log('after.className: ', this.el.className)\n    return this;\n  }\n  hasClass (cls: string) {\n    return this.el.className.indexOf(cls) !== -1\n  }\n\n  show (isRemove = false): Element {\n    isRemove ? this.removeStyle('display') : this.style('display', 'block');\n    return this;\n  }\n\n  hide (): Element {\n    this.style('display', 'none');\n    return this;\n  }\n}\n\nexport function h (tag = 'div'): Element {\n  return new Element(tag)\n}","import { Element, h } from \"./element\";\n\nexport class Icon extends Element{\n\n  img: Element;\n\n  constructor (name: string) {\n    super();\n    this.class('spreadsheet-icon').child(this.img = h().class(`spreadsheet-icon-img ${name}`));\n  }\n\n  replace (name: string) {\n    this.img.class(`spreadsheet-icon-img ${name}`)\n  }\n\n}\n\nexport function buildIcon (name: string) {\n  return new Icon(name);\n}","export function bind<T extends Event>(name: string, fn: (evt: T) => void, target: any = window) {\n  target.addEventListener(name, fn)\n}\nexport function unbind<T extends Event>(name: string, fn: (evt: T) => void, target: any = window) {\n  target.removeEventListener(name, fn)\n}\nexport function mouseMoveUp<T extends Event> (movefunc: (evt: T) => void, upfunc: (evt: T) => void) {\n  bind('mousemove', movefunc)\n  const up = (evt: T) => {\n    unbind('mousemove', movefunc)\n    unbind('mouseup', up)\n    upfunc(evt)\n  }\n  bind('mouseup', up)\n}","export interface Cell {\n  font?: string;\n  format?: string;\n  fontSize?: number;\n  bold?: boolean;\n  italic?: boolean;\n  underline?: boolean;\n  color?: string;\n  backgroundColor?: string;\n  align?: string;\n  valign?: string;\n  wordWrap?: boolean;\n  visable?: boolean;\n  rowspan?: number;\n  colspan?: number;\n  text?: string;\n  merge?: [number, number];\n  [key: string]: any\n}\n\nexport const defaultCell: Cell = {\n  font: 'Microsoft YaHei',\n  format: 'normal',\n  fontSize: 14,\n  bold: false,\n  italic: false,\n  underline: false,\n  color: '#333',\n  backgroundColor: '#fff',\n  align: 'left',\n  valign: 'middle',\n  wordWrap: false,\n  invisible: false,\n  rowspan: 1,\n  colspan: 1,\n  text: '',\n\n}\n\nexport function getStyleFromCell (cell: Cell | null): {[key: string]: string} {\n  const map: {[key: string]: string} = {}\n  if (cell) {\n    if (cell.font) map['font-family'] = cell.font\n    if (cell.fontSize) map['font-size'] = `${cell.fontSize}px`\n    if (cell.bold) map['font-weight'] = 'bold'\n    if (cell.italic) map['font-style'] = 'italic'\n    if (cell.underline) map['text-decoration'] = 'underline'\n    if (cell.color) map['color'] = cell.color\n    if (cell.backgroundColor) map['background-color'] = cell.backgroundColor\n    if (cell.align) map['text-align'] = cell.align\n    if (cell.valign) map['vertical-align'] = cell.valign\n    if (cell.invisible) {\n      map['display'] = 'none'\n    }\n    if (cell.wordWrap) {\n      map['word-wrap'] = 'break-word'\n      map['white-space'] = 'normal'\n    }\n  }\n  return map\n}\n","const _alphabet = ['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z']\nexport function alphabet(index: number): string {\n  const [a, b] = [parseInt(index / _alphabet.length + ''), index % _alphabet.length]\n  // console.log('a: ', a, '; b: ', b)\n  return a > 0 ? `${_alphabet[a - 1]}${_alphabet[b]}` : _alphabet[b]\n}\n\nexport function alphabetIndex (key: string): number {\n  let ret = 0;\n  for (let i = 0; i < key.length; i++) {\n    // console.log(key.charCodeAt(i), key[i])\n    let cindex = key.charCodeAt(i) - 65;\n    ret += i * _alphabet.length + cindex;\n  }\n  return ret;\n}\n","import { alphabetIndex, alphabet } from \"./alphabet\";\n\nexport interface Formula {\n  key: string;\n  title: string;\n  render(ary: Array<number>): number\n}\n\nexport const formulaFilterKey = (v: string, filter: (formula: Formula, param: string) => string) => {\n  if (v[0] === '=') {\n    const fx = v.substring(1, v.indexOf('('))\n    for (let formula of formulas) {\n      if (formula.key.toLowerCase() === fx.toLowerCase()) {\n        return filter(formula, v.substring(v.indexOf('(') + 1, v.indexOf(')')))\n      }\n    }\n  }\n  return v\n}\n\nexport const formulaRender = (v: string, renderCell: (rindex: number, cindex: number) => any) => {\n  return formulaFilterKey(v, (fx, param) => {\n    return fx.render(formulaParamToArray(param, renderCell)) + '';\n  })\n}\n\nexport const formulaReplaceParam = (param: string, rowDiff: number, colDiff: number): string => {\n  return formulaFilterKey(param, (fx, params) => {\n    const replaceFormula = (_v: string):string => {\n      const idx = /\\d+/.exec(_v)\n      if (idx) {\n        let vc = _v.substring(0, idx.index)\n        let vr = parseInt(_v.substring(idx.index))\n        return `${alphabet(alphabetIndex(vc) + colDiff)}${vr + rowDiff}`\n      }\n      return _v;\n    }\n\n    if (params.indexOf(':') !== -1) {\n      params = params.split(':').map(replaceFormula).join(':')\n    } else {\n      params = params.split(',').map(replaceFormula).join(',')\n    }\n    return `=${fx.key}(${params})`\n  })\n}\n\nconst formulaParamToArray = (param: string, renderCell: (rindex: number, cindex: number) => any) => {\n  let paramValues = []\n  try {\n    if (param.indexOf(':') !== -1) {\n      const [min, max] = param.split(':');\n      const idx = /\\d+/.exec(min);\n      const maxIdx = /\\d+/.exec(max);\n      if (idx && maxIdx) {\n        // idx = idx.index;\n        // maxIdx = maxIdx.index;\n        let minC = min.substring(0, idx.index)\n        let minR = parseInt(min.substring(idx.index))\n\n        let maxC = max.substring(0, maxIdx.index)\n        let maxR = parseInt(max.substring(maxIdx.index))\n        // console.log(min, max, minR, maxR, minC, maxC)\n        if (maxC === minC) {\n          for (let i = minR; i <= maxR; i++) {\n            // console.log('value:::', i-1, alphabetIndex(minC), renderCell(i - 1, alphabetIndex(minC)))\n            paramValues.push(renderCell(i - 1, alphabetIndex(minC)))\n          }\n        } else {\n          for (let i = alphabetIndex(minC); i <= alphabetIndex(maxC); i++) {\n            paramValues.push(renderCell(minR - 1, i))\n          }\n        }\n      }\n    } else if (param.indexOf(',') !== -1) {\n      paramValues = param.split(',').map(p => {\n        const idx = /\\d+/.exec(p)\n        if (idx) {\n          const c = p.substring(0, idx.index)\n          const r = p.substring(idx.index)\n          return renderCell(parseInt(r) - 1, alphabetIndex(c))\n        }\n      })\n    }\n  } catch (e) {\n    console.log('warning:', e)\n  }\n  return paramValues;\n}\n\nexport const formulas: Array<Formula> = [\n  {key: 'SUM', title: 'æ±å', render: (vv) => vv.reduce((a, b) => Number(a) + Number(b), 0)},\n  {key: 'AVERAGE', title: 'å¹³åå¼', render: (vv) => vv.reduce((a, b) => Number(a) + Number(b), 0) / vv.length},\n  {key: 'MAX', title: 'æå¤§å¼', render: (vv) => Math.max(...vv.map(v => Number(v)))},\n  {key: 'MIN', title: 'æå°å¼', render: (vv) => Math.min(...vv.map(v => Number(v)))}\n]","export interface Format {\n  key: string;\n  title: string;\n  label?: string;\n  render(txt: string): string;\n}\nexport const formatRenderHtml = (key: string | undefined, txt: string | undefined) => {\n  for (let i = 0; i < formats.length; i++) {\n    if (formats[i].key === key) {\n      return formats[i].render(txt || '')\n    }\n  }\n  return txt || ''\n}\n\nconst formatNumberRender = (v: string) => {\n  if (/^(-?\\d*.?\\d*)$/.test(v)) {\n    v = Number(v).toFixed(2).toString()\n    const parts = v.split('.')\n    parts[0] = parts[0].toString().replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1' + ',')\n    return parts.join('.')\n  }\n  return v\n}\n\nconst formatRender = (v: string) => v\n\nexport const formats: Array<Format> = [\n  {key: 'normal', title: 'Normal', render: formatRender},\n  {key: 'text', title: 'Text', render: formatRender},\n  {key: 'number', title: 'Number', label: '1,000.12', render: formatNumberRender},\n  {key: 'percent', title: 'Percent', label: '10.12%', render: (v) => `${formatNumberRender(v)}%`},\n  {key: 'RMB', title: 'RMB', label: 'ï¿¥10.00', render: (v) => `ï¿¥${formatNumberRender(v)}`},\n  {key: 'USD', title: 'USD', label: '$10.00', render: (v) => `$${formatNumberRender(v)}`}\n]","import { Element, h } from \"./base/element\";\nimport { Cell } from \"../core/cell\";\nimport { mouseMoveUp } from \"./event\"\n\nexport class Editorbar {\n  el: Element;\n  value: Cell | null = null; // éä¸­çå½åçcell\n  textarea: Element;\n  label: Element;\n  change: (v: Cell) => void = (v) => {};\n  constructor () {\n    this.el = h().class('spreadsheet-editor-bar').children([\n      h().class('spreadsheet-formula-bar').children([\n        this.label = h().class('spreadsheet-formula-label'),\n        this.textarea = h('textarea').on('input', (evt) => this.input(evt))\n      ]),\n      // h().class('spreadsheet-formular-bar-resizer').on('mousedown', this.mousedown)\n    ])\n  }\n\n  set (title: string, value: Cell | null) {\n    this.label.html(title)\n    this.setValue(value)\n  }\n\n  setValue (value: Cell | null) {\n    this.value = value\n    this.textarea.val(value && value.text || '')\n  }\n\n  input (evt: any) {\n    const v = evt.target.value\n    if (!/^\\s*$/.test(v)) {\n      if (this.value) {\n        this.value.text = v\n      } else {\n        this.value = {text: v}\n      }\n      this.change(this.value)\n    }\n  }\n\n}","import { Element, h } from \"./element\";\n\nconst colorss = [\n  ['rgb(192, 0, 0)', 'rgb(255, 0, 0)', 'rgb(255, 192, 3)', 'rgb(255, 255, 0)','rgb(145, 208, 81)', 'rgb(0, 175, 80)', 'rgb(0, 176, 240)', 'rgb(0, 112, 192)', 'rgb(0, 32, 96)', 'rgb(112, 48, 159)'],\n  ['rgb(255, 255, 255)', 'rgb(0, 0, 0)', 'rgb(231, 230, 230)', 'rgb(68, 84, 106)', 'rgb(68, 114, 196)', 'rgb(237, 125, 49)', 'rgb(165, 165, 165)', 'rgb(255, 192, 3)', 'rgb(91, 155, 213)', 'rgb(112, 173, 71)'],\n  ['rgb(244, 245, 248)', 'rgb(132, 132, 132)', 'rgb(208, 206, 206)', 'rgb(214, 220, 228)', 'rgb(217, 226, 242)', 'rgb(250, 229, 213)', 'rgb(237, 237, 237)', 'rgb(255, 242, 204)', 'rgb(222, 235, 246)', 'rgb(226, 239, 217)'],\n  ['rgb(216, 216, 216)', 'rgb(89, 89, 89)', 'rgb(175, 171, 171)', 'rgb(173, 185, 202)', 'rgb(180, 198, 231)', 'rgb(247, 203, 172)', 'rgb(219, 219, 219)', 'rgb(254, 229, 152)', 'rgb(189, 215, 238)', 'rgb(197, 224, 179)'],\n  ['rgb(191, 191, 191)', 'rgb(63, 63, 63)', 'rgb(117, 112, 112)', 'rgb(132, 150, 176)', 'rgb(142, 170, 216)', 'rgb(244, 177, 131)', 'rgb(201, 201, 201)', 'rgb(255, 217, 100)', 'rgb(157, 194, 229)', 'rgb(168, 208, 141)'],\n  ['rgb(165, 165, 165)', 'rgb(38, 38, 38)', 'rgb(58, 56, 56)', 'rgb(51, 63, 79)', 'rgb(47, 84, 150)', 'rgb(197, 91, 17)', 'rgb(123, 123, 123)', 'rgb(191, 144, 1)', 'rgb(46, 117, 181)', 'rgb(83, 129, 53)'],\n  ['rgb(126, 126, 126)', 'rgb(12, 12, 12)', 'rgb(23, 22, 22)', 'rgb(35, 42, 53)', 'rgb(30, 56, 100)', 'rgb(131, 61, 11)', 'rgb(82, 82, 82)', 'rgb(126, 96, 0)', 'rgb(31, 78, 121)', 'rgb(55, 86, 35)']\n]\n\nexport class ColorPanel extends Element {\n\n  constructor (click: (color: string) => void) {\n    super();\n    this.class('spreadsheet-color-panel')\n    .child(\n      h('table').child(\n        h('tbody').children(\n          colorss.map(colors => {\n            return h('tr').children(\n              colors.map(color => {\n                return h('td').child(\n                  h()\n                    .class('color-cell')\n                    .on('click', click.bind(null, color))\n                    .style('background-color', color)\n                )\n              })\n            )\n          })\n        )));\n  }\n\n}\n\nexport function buildColorPanel (click: (color: string) => void) {\n  return new ColorPanel(click);\n}","import { Element } from \"./element\";\n\nexport class Menu extends Element{\n\n  constructor (align = 'vertical') {\n    super();\n    this.class(`spreadsheet-menu ${align}`)\n  }\n\n}\n\nexport function buildMenu (align = 'vertical') {\n  return new Menu(align);\n}","import { Element, h } from \"./element\";\nimport { buildIcon } from \"./icon\";\n\nexport class Dropdown extends Element {\n  content: Element;\n  title: Element;\n\n  constructor (title: string | Element, width: string, contentChildren: Element[]) {\n    super();\n    this.class('spreadsheet-dropdown spreadsheet-item');\n\n    this.content = h().class('spreadsheet-dropdown-content')\n      .children(contentChildren)\n      .on('click', (evt) => this.toggleHandler(evt))\n      .style('width', width).hide();\n\n    this.child(h().class('spreadsheet-dropdown-header').children([\n      this.title = typeof title === 'string' ? h().class('spreadsheet-dropdown-title').child(title) : title,\n      h().class('spreadsheet-dropdown-icon').on('click', (evt) => this.toggleHandler(evt)).child(buildIcon('arrow-down'))\n    ])).child(this.content);\n  }\n\n  documentHandler (e: any) {\n    if (this.content.el.contains(e.target)) {\n      return false\n    }\n    this.content.hide()\n    this.deactive()\n    document.removeEventListener('click', this.content.data('_outsidehandler'))\n  }\n\n  toggleHandler (evt: Event) {\n    // evt.stopPropagation()\n    // console.log(this.content.isHide(), \">>>\")\n    if (this.content.isHide()){\n      const clickoutsize = (evt: Event) => {\n        this.documentHandler(evt)\n      }\n\n      this.content.show()\n      this.active()\n      this.content.data('_outsidehandler', clickoutsize)\n      setTimeout(() => {\n        document.addEventListener('click', clickoutsize)\n      }, 0)\n    } else {\n      this.content.hide()\n      this.deactive()\n      document.removeEventListener('click', this.content.data('_outsidehandler'))\n    }\n  }\n}\nexport function buildDropdown(title: string | Element, width: string, contentChildren: Element[]) {\n  return new Dropdown(title, width, contentChildren)\n}","import { Element } from \"./element\";\nimport { Icon, buildIcon } from \"./icon\";\n\nexport class Item extends Element {\n\n  iconEl: Icon | null = null;\n\n  static build (): Item {\n    return new Item()\n  }\n  \n  constructor () {\n    super();\n    this.class('spreadsheet-item');\n  }\n\n  icon (name: string) {\n    this.child(this.iconEl = buildIcon(name))\n    return this;\n  }\n\n  replaceIcon (name: string) {\n    this.iconEl && this.iconEl.replace(name)\n  }\n\n}\n\nexport function buildItem (): Item {\n  return new Item();\n}","import { Element, h } from \"./base/element\";\nimport { Spreadsheet } from \"../core/index\";\nimport { Cell, getStyleFromCell, defaultCell } from '../core/cell';\nimport { Table } from './table';\nimport { buildItem, Item } from './base/item';\nimport { buildIcon } from './base/icon';\nimport { buildDropdown, Dropdown } from './base/dropdown';\nimport { buildMenu } from './base/menu';\nimport { buildColorPanel } from './base/colorPanel';\nimport { Font } from \"../core/font\";\nimport { Format } from \"../core/format\";\n\nexport class Toolbar {\n  el: Element;\n  defaultCell: Cell;\n\n  target: Element | null = null;\n  currentCell: Cell | null = null;\n\n  elUndo: Element;\n  elRedo: Element;\n  elPaintformat: Element;\n  elClearformat: Element;\n  elFormat: Dropdown;\n  elFont: Dropdown;\n  elFontSize: Dropdown;\n  elFontWeight: Element;\n  elFontStyle: Element;\n  elTextDecoration: Element;\n  elColor: Dropdown;\n  elBackgroundColor: Dropdown;\n  elMerge: Element;\n  elAlign: Dropdown;\n  elValign: Dropdown;\n  elWordWrap: Element;\n\n  change: (key: keyof Cell, v: any) => void = (key, v) => {}\n  redo: () => boolean = () => false\n  undo: () => boolean = () => false\n\n  constructor (public ss: Spreadsheet) {\n    this.defaultCell = ss.data.cell\n\n    this.el = h().class('spreadsheet-toolbar').child(\n        buildMenu('horizontal').children([\n          this.elUndo = this.buildUndo(),\n          this.elRedo = this.buildRedo(),\n          this.elPaintformat = this.buildPaintformat(),\n          this.elClearformat = this.buildClearformat(),\n          this.elFormat = this.buildFormats(),\n          this.buildSeparator(),\n          this.elFont = this.buildFonts(),\n          this.elFontSize = this.buildFontSizes(),\n          this.buildSeparator(),\n          this.elFontWeight = this.buildFontWeight(),\n          this.elFontStyle = this.buildFontStyle(),\n          this.elTextDecoration = this.buildTextDecoration(),\n          this.elColor = this.buildColor(),\n          this.buildSeparator(),\n          this.elBackgroundColor = this.buildBackgroundColor(),\n          this.elMerge = this.buildMerge(),\n          this.buildSeparator(),\n          this.elAlign = this.buildAligns(),\n          this.elValign = this.buildValigns(),\n          this.elWordWrap = this.buildWordWrap()\n        ])\n      )\n    ;\n  }\n\n  set (target: Element, cell: Cell | null) {\n    this.target = target\n    this.setCell(cell)\n  }\n\n  private setCell (cell: Cell | null) {\n    this.currentCell = cell\n    this.setCellStyle()\n  }\n\n  private setCellStyle () {\n    const { target, currentCell, defaultCell, ss } = this\n    // console.log(':::', currentCell)\n    if (target) {\n      // target.clearStyle()\n      // target.styles(getStyleFromCell(currentCell))\n      this.elFormat.title.html(ss.getFormat(currentCell !== null && currentCell.format || defaultCell.format).title);\n      this.elFont.title.html(ss.getFont(currentCell !== null && currentCell.font || defaultCell.font).title);\n      this.elFontSize.title.html((currentCell !== null && currentCell.fontSize || defaultCell.fontSize) + '');\n      this.elFontWeight.active(currentCell !== null && currentCell.bold !== undefined && currentCell.bold !== defaultCell.bold);\n      this.elFontStyle.active(currentCell !== null && currentCell.italic !== undefined && currentCell.italic !== defaultCell.italic);\n      this.elTextDecoration.active(currentCell !== null && currentCell.underline !== undefined && currentCell.underline !== defaultCell.underline);\n      this.elColor.title.style('border-bottom-color', currentCell !== null && currentCell.color || defaultCell.color);\n      this.elBackgroundColor.title.style('border-bottom-color', currentCell !== null && currentCell.backgroundColor || defaultCell.backgroundColor);\n      (<any>this.elAlign.title).replace(`align-${currentCell !== null && currentCell.align || defaultCell.align}`);\n      (<any>this.elValign.title).replace(`valign-${currentCell !== null && currentCell.valign || defaultCell.valign}`);\n      this.elWordWrap.active(currentCell !== null && currentCell.wordWrap !== undefined && currentCell.wordWrap !== defaultCell.wordWrap);\n      // console.log('select:', currentCell)\n      if ((currentCell !== null && currentCell.rowspan && currentCell.rowspan > 1)\n        || (currentCell !== null && currentCell.colspan && currentCell.colspan > 1)) {\n        this.elMerge.active(true);\n      } else {\n        this.elMerge.active(false);\n      }\n    }\n  }\n\n  setRedoAble (flag: boolean) {\n    flag ? this.elRedo.able() : this.elRedo.disabled()\n  }\n\n  setUndoAble (flag: boolean) {\n    flag ? this.elUndo.able() : this.elUndo.disabled()\n  }\n\n  private buildSeparator (): Element {\n    return h().class('spreadsheet-item-separator')\n  }\n  private buildAligns (): Dropdown {\n    const titleIcon = buildIcon(`align-${this.defaultCell.align}`)\n    const clickHandler = (it: string) => {\n      titleIcon.replace(`align-${it}`)\n      this.change('align', it)\n    }\n    return buildDropdown(titleIcon, '60px', [buildMenu().children(\n      ['left', 'center', 'right'].map(it => \n        buildItem()\n          .child(buildIcon(`align-${it}`).style('text-align', 'center'))\n          .on('click', clickHandler.bind(null, it))\n      )\n    )])\n  }\n  private buildValigns (): Dropdown {\n    const titleIcon = buildIcon(`valign-${this.defaultCell.valign}`)\n    const clickHandler = (it: string) => {\n      titleIcon.replace(`valign-${it}`)\n      this.change('valign', it)\n    }\n    return buildDropdown(titleIcon, '60px', [buildMenu().children(\n      ['top', 'middle', 'bottom'].map(it => \n        buildItem()\n          .child(buildIcon(`valign-${it}`).style('text-align', 'center'))\n          .on('click', clickHandler.bind(null, it))\n        )\n    )])\n  }\n  private buildWordWrap (): Element {\n    return buildIconItem('textwrap', (is) => this.change('wordWrap', is))\n  }\n  private buildFontWeight (): Element {\n    return buildIconItem('bold', (is) => this.change('bold', is))\n  }\n  private buildFontStyle (): Element {\n    return buildIconItem('italic', (is) => this.change('italic', is))\n  }\n  private buildTextDecoration (): Element {\n    return buildIconItem('underline', (is) => this.change('underline', is))\n  }\n  private buildMerge (): Element {\n    return buildIconItem('merge', (is) => this.change('merge', is))\n  }\n  private buildColor (): Dropdown {\n    const clickHandler = (color: string) => {\n      this.elColor.title.style('border-bottom-color', color)\n      this.change('color', color)\n    }\n    return buildDropdown(\n      buildIcon('text-color').styles({'border-bottom': `3px solid ${this.defaultCell.color}`, 'margin-top': '2px', height: '16px'}),\n      'auto',\n      [buildColorPanel(clickHandler)])\n  }\n  private buildBackgroundColor (): Dropdown {\n    const clickHandler = (color: string) => {\n      this.elBackgroundColor.title.style('border-bottom-color', color)\n      this.change('backgroundColor', color)\n    }\n    return buildDropdown(\n      buildIcon('cell-color').styles({'border-bottom': `3px solid ${this.defaultCell.backgroundColor}`, 'margin-top': '2px', height: '16px'}),\n      'auto',\n      [buildColorPanel(clickHandler)])\n  }\n  private buildUndo (): Element {\n    return buildItem().child(buildIcon('undo'))\n      .on('click', (evt) => {\n        this.undo() ? this.elUndo.able() : this.elUndo.disabled()\n      })\n      .disabled()\n  }\n  private buildRedo (): Element {\n    return buildItem().child(buildIcon('redo'))\n      .on('click', (evt) => {\n        this.redo() ? this.elRedo.able() : this.elRedo.disabled()\n      })\n      .disabled()\n  }\n  private buildPaintformat (): Element {\n    return buildIconItem('paintformat', (is) => { \n      this.change('paintformat', true);\n      this.elPaintformat.deactive();\n    })\n  }\n  private buildClearformat (): Element {\n    return buildIconItem('clearformat', (is) => { \n      this.change('clearformat', true);\n      this.elClearformat.deactive();\n    });\n  }\n  private buildFormats (): Dropdown {\n    const clickHandler = (it: Format) => {\n      this.elFormat.title.html(this.ss.getFormat(it.key).title);\n      this.change('format', it.key)\n    }\n    return buildDropdown(this.ss.getFormat(this.defaultCell.format).title, '250px', [buildMenu().children(\n      this.ss.formats.map(it => \n        buildItem()\n          .children([it.title, h().class('label').child(it.label||'')])\n          .on('click', clickHandler.bind(null, it))\n        )\n    )])\n  }\n  private buildFonts (): Dropdown {\n    const clickHandler = (it: Font) => {\n      this.elFont.title.html(it.title)\n      this.change('font', it.key)\n    }\n    return buildDropdown(this.ss.getFont(this.defaultCell.font).title, '170px', [buildMenu().children(\n      this.ss.fonts.map(it => { \n        return buildItem()\n          .child(it.title)\n          .on('click', clickHandler.bind(null, it))\n      })\n    )])\n  }\n  private buildFontSizes (): Dropdown {\n    const clickHandler = (it: number) => {\n      this.elFontSize.title.html(`${it}`)\n      this.change('fontSize', it)\n    }\n    return buildDropdown(this.defaultCell.fontSize + '', '70px', [buildMenu().children(\n      [6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 30, 36].map(it => {\n        return buildItem()\n          .child(`${it}`)\n          .on('click', clickHandler.bind(null, it))\n      })\n    )])\n  }\n}\n\nconst buildIconItem = (iconName: string, change: (flag: boolean) => void) => {\n  const el = buildItem().child(buildIcon(iconName))\n  el.on('click', (evt) => {\n    let is = el.isActive()\n    is ? el.deactive() : el.active()\n    change(!is)\n  })\n  return el;\n}","import { Element, h } from \"./base/element\";\nimport { mouseMoveUp } from './event';\n\nexport class Resizer {\n  el: Element;\n  resizer: Element;\n  resizerLine: Element;\n  moving: boolean = false;\n  index: number = 0;\n  constructor (public vertical: boolean, public change: (index: number, distance: number) => void) {\n    this.el = h().class('spreadsheet-resizer-wrapper').children([\n      this.resizer = h().class(`spreadsheet-resizer ${vertical ? 'vertical' : 'horizontal'}`)\n        .on('mousedown', (evt: Event) => this.mousedown(evt)),\n      this.resizerLine = h().class(`spreadsheet-resizer-line ${vertical ? 'vertical' : 'horizontal'}`).hide()\n    ])\n  }\n\n  set (target: any, index: number) {\n    if (this.moving) return ;\n    this.index = index\n    const { vertical } = this\n    const { offsetLeft, offsetTop, offsetHeight, offsetWidth, parentNode } = target\n    // console.log(parentNode.parentNode.parentNode.parentNode.nextSibling.offsetHeight)\n    this.resizer.styles({\n      left: `${vertical ? offsetLeft + offsetWidth - 5 : offsetLeft}px`,\n      top: `${vertical ? offsetTop : offsetTop + offsetHeight - 5 + 24}px`,\n      width: `${vertical ? 5 : offsetWidth}px`,\n      height: `${vertical ? offsetHeight : 5}px`\n    })\n    this.resizerLine.styles({\n      left: `${vertical ? offsetLeft + offsetWidth : offsetLeft}px`,\n      top: `${vertical ? offsetTop : offsetTop + offsetHeight + 24}px`,\n      width: `${vertical ? 0 : parentNode.parentNode.parentNode.parentNode.parentNode.nextSibling.offsetWidth - 15}px`,\n      height: `${vertical ? parentNode.parentNode.parentNode.parentNode.nextSibling.offsetHeight + parentNode.offsetHeight : 0}px`\n    })\n    // this.el.show()\n  }\n\n  mousedown (evt: any) {\n    let startEvt = evt;\n    let distance = 0;\n    this.resizerLine.show()\n    mouseMoveUp((e: any) => {\n      this.moving = true\n      if (startEvt !== null && e.buttons === 1) {\n        if (this.vertical) {\n          const d = e.x - startEvt.x\n          distance += d\n          this.resizer.style('left', `${this.resizer.offset().left + d}px`)\n          this.resizerLine.style('left', `${this.resizerLine.offset().left + d}px`)\n        } else {\n          const d = e.y - startEvt.y\n          distance += d\n          this.resizer.style('top', `${this.resizer.offset().top + d}px`)\n          this.resizerLine.style('top', `${this.resizerLine.offset().top + d}px`)\n        }\n        startEvt = e\n      }\n    }, (e: any) => {\n      this.change(this.index, distance)\n      startEvt = null\n      this.resizerLine.hide()\n      distance = 0\n      this.moving = false\n    })\n  }\n}","import { Element, h } from \"./base/element\";\nimport { bind, mouseMoveUp } from './event';\nimport { Spreadsheet } from \"../core/index\";\nimport { Table } from './table';\n\nexport class Selector {\n  topEl: Element;\n  rightEl: Element;\n  bottomEl: Element;\n  leftEl: Element;\n  areaEl: Element;\n  cornerEl: Element;\n  copyEl: Element;\n  el: Element;\n  _offset = {left: 0, top: 0, width: 0, height: 0};\n\n  startTarget: any;\n  endTarget: any;\n\n  change: () => void = () => {};\n  changeCopy: (evt: any, arrow: 'bottom' | 'top' | 'left' | 'right', startRow: number, startCol: number, stopRow: number, stopCol: number) => void \n    = (evt, arrow, startRow, startCol, stopRow, stopCol) => {};\n\n  constructor (public ss: Spreadsheet, public table: Table) {\n    this.topEl = h().class('top-border');\n    this.rightEl = h().class('right-border');\n    this.bottomEl = h().class('bottom-border');\n    this.leftEl = h().class('left-border');\n    this.areaEl = h().class('area-border');\n    this.cornerEl = h().class('corner').on('mousedown', (evt) => this.cornerMousedown(evt));\n    this.copyEl = h().class('copy-border');\n    this.el = h().class('spreadsheet-borders').children([\n      this.topEl,\n      this.rightEl,\n      this.bottomEl,\n      this.leftEl,\n      this.areaEl,\n      this.cornerEl,\n      this.copyEl\n    ])\n    bind('keydown', (evt: Event) => { this.keydown(evt) })\n  }\n\n  mousedown (evt: any) {\n    // console.log('>>>>>>>>selector>>')\n    // console.log(this, evt, evt.type, evt.detail, evt.buttons, evt.button)\n    if (evt.detail === 1 && evt.target.getAttribute('type') === 'cell') {\n      // console.log(evt.shiftKey)\n      if (evt.shiftKey) {\n        this.endTarget = evt.target\n        this.setOffset()\n        return\n      }\n      Object.assign(this, {startTarget: evt.target, endTarget: evt.target})\n      this.setOffset()\n\n      mouseMoveUp((e: any) => {\n        if (e.buttons === 1 && e.target.getAttribute('type') === 'cell') {\n          this.endTarget = e.target\n          this.setOffset()\n        }\n      }, (e) => { this.change() })\n    }\n  }\n\n  private keydown (evt: any) {\n    // up, down, left, right\n    switch (evt.keyCode) {\n      case 37: // left\n        break;\n      case 38: // up\n        break;\n      case 39: // right\n        break;\n      case 40: // down\n        break;\n    }\n  }\n\n  private cornerMousedown (evt: any) {\n    const { select } = this.ss\n    if (select === null) {\n      return ;\n    }\n    const [stopRow, stopCol] = select.stop;\n    const [startRow, startCol] = select.start;\n    \n    let boxRange:['bottom' | 'top' | 'left' | 'right', number, number, number, number] | null = null;\n    mouseMoveUp((e: any) => {\n      const rowIndex = e.target.getAttribute('row-index')\n      const colIndex = e.target.getAttribute('col-index')\n      if (rowIndex && colIndex) {\n        this.copyEl.show();\n        let rdiff = stopRow - rowIndex\n        let cdiff = stopCol - colIndex\n        let _rdiff = startRow - rowIndex\n        let _cdiff = startCol - colIndex\n        const {left, top, height, width} = this._offset;\n        // console.log(rdiff, cdiff, ',,,', _rdiff, _cdiff)\n        if (rdiff < 0) {\n          // bottom\n          // console.log('FCK=>bottom', this.rowsHeight(stopRow, stopRow + Math.abs(rdiff)), rdiff)\n          this.copyEl.styles({\n            left: `${left - 1}px`,\n            top: `${top - 1}px`,\n            width: `${width - 1}px`,\n            height: `${this.rowsHeight(stopRow - select.rowLen() + 1, stopRow + Math.abs(rdiff)) - 1}px`});\n          boxRange = ['bottom', stopRow + 1, startCol, stopRow + Math.abs(rdiff), stopCol]\n        } else if (cdiff < 0) {\n          // right\n          // console.log('FCK=>right')\n          this.copyEl.styles({\n            left: `${left - 1}px`,\n            top: `${top - 1}px`,\n            width: `${this.colsWidth(stopCol - select.colLen() + 1, stopCol + Math.abs(cdiff)) - 1}px`,\n            height: `${height - 1}px`});\n          boxRange = ['right', startRow, stopCol + 1, stopRow, stopCol + Math.abs(cdiff)]\n        } else if (_rdiff > 0) {\n          // top\n          // console.log('FCK=>top')\n          const h = this.rowsHeight(startRow - _rdiff, startRow - 1)\n          this.copyEl.styles({\n            left: `${left - 1}px`,\n            top: `${top - h - 1}px`,\n            width: `${width - 1}px`,\n            height: `${h - 1}px`});\n          boxRange = ['top', startRow - _rdiff, startCol, startRow - 1, stopCol]\n        } else if (_cdiff > 0) {\n          // left\n          // console.log('FCK=>left')\n          const w = this.colsWidth(startCol - _cdiff, startCol - 1)\n          this.copyEl.styles({\n            left: `${left - w - 1}px`,\n            top: `${top - 1}px`,\n            width: `${w - 1}px`,\n            height: `${height - 1}px`});\n          boxRange = ['left', startRow, startCol - _cdiff, stopRow, startCol - 1]\n        } else {\n          this.copyEl.styles({\n            left: `${left - 1}px`,\n            top: `${top - 1}px`,\n            width: `${width - 1}px`,\n            height: `${height - 1}px`});\n          boxRange = null\n        }\n      }\n    }, (e) => {\n      this.copyEl.hide()\n      if (boxRange !== null) {\n        const [arrow, startRow, startCol, stopRow, stopCol] = boxRange\n        this.changeCopy(e, arrow, startRow, startCol, stopRow, stopCol)\n      }\n    });\n  }\n\n  reload () {\n    this.setOffset()\n  }\n\n  private setOffset () {\n    if (this.startTarget === undefined) return ;\n    let { select } = this.ss\n\n    // console.log('select: ', select, this.table)\n    if (select) {\n      // console.log('clear>>>>>:::')\n      // clear\n      const [minRow, minCol] = select.start\n      const [maxRow, maxCol] = select.stop\n      _forEach(minRow, maxRow, this.table.firsttds, (e) => { e.deactive() })\n      _forEach(minCol, maxCol, this.table.ths, (e) => { e.deactive() })\n    }\n\n    select = this.ss.buildSelect(this.startTarget, this.endTarget)\n    const [minRow, minCol] = select.start\n    const [maxRow, maxCol] = select.stop\n    // let height = 0, width = 0;\n    const height = this.rowsHeight(minRow, maxRow, (e) => e.active())\n    // _forEach(minRow, maxRow, this.table.firsttds, (e) => { \n    //   e.active()\n    //   height += parseInt(e.offset().height)\n    // })\n    // height /= 2\n    const width = this.colsWidth(minCol, maxCol, (e) => e.active())\n    // _forEach(minCol, maxCol, this.table.ths, (e) => {\n    //   e.active()\n    //   width += parseInt(e.offset().width)\n    // })\n\n    // console.log('>>', minRow, minCol, maxRow, maxCol, height, width)\n    const td = this.table.td(minRow, minCol)\n    if (td) {\n      // console.log('td:', td)\n      const {left, top} = td.offset()\n      this._offset = {left, top, width, height};\n\n      this.topEl.styles({left: `${left - 1}px`, top: `${top - 1}px`, width: `${width + 1}px`, height: '2px'})\n      this.rightEl.styles({left: `${left + width - 1}px`, top: `${top - 1}px`, width: '2px', height: `${height}px`})\n      this.bottomEl.styles({left: `${left - 1}px`, top: `${top + height - 1}px`, width: `${width}px`, height: '2px'})\n      this.leftEl.styles({left: `${left - 1}px`, top: `${top - 1}px`, width: '2px', height: `${height}px`})\n      this.areaEl.styles({left: `${left}px`, top: `${top}px`, width: `${width - 2}px`, height: `${height - 2}px`})\n      this.cornerEl.styles({left: `${left + width - 5}px`, top: `${top + height - 5}px`})\n    }\n  }\n  private rowsHeight (minRow:number, maxRow:number, cb: (e: Element) => void = (e) => {}): number {\n    let height = 0\n    _forEach(minRow, maxRow, this.table.firsttds, (e) => { \n      cb(e)\n      height += parseInt(e.offset().height)\n    })\n    height /= 2\n    return height\n  }\n  private colsWidth (minCol: number, maxCol: number, cb: (e: Element) => void = (e) => {}): number {\n    let width = 0\n    _forEach(minCol, maxCol, this.table.ths, (e) => {\n      cb(e)\n      width += parseInt(e.offset().width)\n    })\n    return width\n  }\n}\n\nconst _forEach = (start: number, stop: number, elements: {[key: string]: Array<Element> | Element}, cb: (e: Element) => void): void => {\n  for (let i = start; i <= stop; i++) {\n    const es = elements[i + ''];\n    if (es) {\n      if (es instanceof Element) {\n        cb(es)\n      } else {\n        es.forEach(e => cb(e))\n      }\n    }\n  }\n}\n\nexport class DashedSelector {\n  el: Element;\n  constructor () {\n    this.el = h().class('spreadsheet-borders dashed').hide();\n  }\n\n  set (selector: Selector) {\n    if (selector._offset) {\n      const { left, top, width, height } = selector._offset;\n      this.el\n        .style('left', `${left - 2}px`)\n        .style('top', `${top - 2}px`)\n        .style('width', `${width}px`)\n        .style('height', `${height}px`)\n        .show();\n    }\n  }\n\n  hide () {\n    this.el.hide();\n  }\n}\n","import { Element, h } from \"./base/element\";\nimport { Cell, getStyleFromCell } from \"../core/cell\"\n\nexport class Editor {\n  el: Element;\n  target: HTMLElement | null = null; // éä¸­çå½åçelement\n  value: Cell | null = null; // éä¸­çå½åçcell\n  editor: Element;\n  textarea: Element;\n  textline: Element; // è®¡ç®è¾å¥ææ¬çå®½åº¦ç¨çelement\n  change: (v: Cell) => void = (v) => {};\n  constructor (public defaultRowHeight: number) {\n\n    this.el = h().children([this.editor = h().class('spreadsheet-editor').children([\n        this.textarea = h('textarea')\n          .on('input', (evt: Event) => this.inputChange(evt)),\n        this.textline = h().styles({visibility: 'hidden', overflow: 'hidden', position: 'fixed', top: '0', left: '0'})\n      ])\n    ]).hide()\n  }\n\n  onChange (change: (v: Cell) => void) {\n    this.change = change\n  }\n\n  set (target: HTMLElement, value: Cell | null) {\n    // console.log('set::>>')\n    this.target = target;\n    const text = this.setValue(value)\n    this.el.show();\n    (<any>this.textarea.el).setSelectionRange(text.length, text.length);\n    setTimeout(() => (<any>this.textarea.el).focus(), 10)\n    this.reload();\n  }\n\n  setValue (value: Cell | null): string {\n    this.setStyle(value);\n    if (value) {\n      this.value = value;\n      const text = value.text || '';\n      this.textarea.val(text);\n      this.textline.html(text);\n      return text\n    } else {\n      return '';\n    }\n  }\n  setStyle (value: Cell | null): void {\n    let attrs = {width: this.textarea.style('width'), height: this.textarea.style('height')}\n    this.textarea.styles(Object.assign(attrs, getStyleFromCell(value)), true)\n  }\n\n  clear () {\n    // console.log('clear:>>>')\n    this.el.hide();\n    this.target = null;\n    this.value = null;\n    this.textarea.val('')\n    this.textline.html('')\n  }\n\n  private inputChange (evt: any) {\n    const v = evt.target.value\n    if (!/^\\s*$/.test(v)) {\n      if (this.value) {\n        this.value.text = v\n      } else {\n        this.value = {text: v}\n      }\n    }\n    this.textline.html(v);\n    this.reload()\n  }\n\n  reload () {\n    // setTimeout(() => {\n      if (this.target) {\n        const { offsetTop, offsetLeft, offsetWidth, offsetHeight } = this.target\n        this.editor.styles({left: `${offsetLeft - 1}px`, top: `${offsetTop - 1}px`})\n        this.textarea.styles({width: `${offsetWidth - 8}px`, height: `${offsetHeight - 2}px`})\n        let ow = this.textline.offset().width + 16\n        // console.log(maxWidth, ow, '>>>>')\n        if (this.value) {\n          if (this.value.wordWrap) {\n            // å¦æååæ ¼èªå¨æ¢è¡ï¼é£ä¹å®½åº¦åºå®ï¼é«åº¦åå\n            // this.textarea.style('height', 'auto');\n            const h = (parseInt(ow / offsetWidth + '') + (ow % offsetWidth > 0 ? 1 : 0)) * this.defaultRowHeight;\n            if (h > offsetHeight) {\n              this.textarea.style('height', `${h}px`);\n            }\n          } else {\n            const clientWidth = document.documentElement.clientWidth\n            const maxWidth = clientWidth - offsetLeft - 24\n            if (ow > offsetWidth) {\n              if (ow > maxWidth) {\n                // console.log(':::::::::', ow, maxWidth)\n                const h = (parseInt(ow / maxWidth + '') + (ow % maxWidth > 0 ? 1 : 0)) * this.defaultRowHeight;\n                if (h > offsetHeight) {\n                  this.textarea.style('height', `${h}px`)\n                } else {\n                  this.textarea.style('height', `${offsetHeight}px`)\n                }\n                ow = maxWidth\n              }\n              this.textarea.style('width', `${ow}px`)\n            }\n          }\n        }\n      }\n    // }, 0)\n    \n  }\n}","import { Element, h } from \"./base/element\";\nimport { Spreadsheet, SpreadsheetData } from '../core/index'\nimport { Editor } from './editor';\nimport { Selector, DashedSelector } from './selector';\nimport { Resizer } from './resizer';\nimport { Editorbar } from \"./editorbar\";\nimport { Toolbar } from \"./toolbar\";\nimport { Cell, getStyleFromCell } from \"../core/cell\";\nimport { formatRenderHtml } from \"../core/format\";\nimport { formulaRender } from \"../core/formula\";\nimport { bind } from \"./event\";\n\ninterface Map<T> {\n  [key: string]: T\n}\n\nexport class Table {\n  cols: Map<Array<Element>> = {};\n  firsttds: Map<Array<Element>> = {};\n  tds: Map<Element> = {};\n  ths: Map<Element> = {};\n  ss: Spreadsheet;\n\n  el: Element;\n  header: Element;\n  fixedLeftBody: Element | null = null;\n\n  editor: Editor;\n  rowResizer: Resizer;\n  colResizer: Resizer;\n\n  selector: Selector;\n  dashedSelector: DashedSelector;\n  state: 'copy' | 'cut' | 'copyformat' | null = null;\n\n  currentIndexs: [number, number] | null = null;\n\n  bodyHeight: () => number;\n\n  // change\n  change: (data: SpreadsheetData) => void = () => {}\n  editorChange: (v: Cell) => void = (v) => {}\n  clickCell: (rindex: number, cindex: number, v: Cell | null) => void = (rindex, cindex, v) => {}\n\n  constructor (ss: Spreadsheet, bodyHeightFn?: () => number) {\n    this.ss = ss;\n    this.ss.change = (data) => {\n      this.change(data)\n    }\n\n    this.editor = new Editor(ss.defaultRowHeight())\n    this.rowResizer = new Resizer(false, (index, distance) => this.changeRowResizer(index, distance))\n    this.colResizer = new Resizer(true, (index, distance) => this.changeColResizer(index, distance))\n    this.selector = new Selector(this.ss, this);\n    this.selector.change = () => this.selectorChange();\n    this.selector.changeCopy = (e, arrow, startRow, startCol, stopRow, stopCol) => {\n      this.selectorChangeCopy(e, arrow, startRow, startCol, stopRow, stopCol);\n    }\n    this.dashedSelector = new DashedSelector();\n\n    if (bodyHeightFn) {\n      this.bodyHeight = bodyHeightFn\n    } else {\n      this.bodyHeight = (): number => {\n        return document.documentElement.clientHeight - 24 - 41 - 26\n      }\n    }\n    this.el = h().class('spreadsheet-table').children([\n      this.colResizer.el,\n      this.rowResizer.el,\n      this.buildFixedLeft(),\n      this.header = this.buildHeader(),\n      this.buildBody()\n    ]);\n\n    // bind ctrl + c, ctrl + x, ctrl + v\n    bind('keydown', (evt: any) => {\n      // ctrlKey\n      if (evt.ctrlKey) {\n        // ctrl + c\n        if (evt.keyCode === 67) {\n          this.copy();\n          evt.returnValue = false\n        }\n        // ctrl + x\n        if (evt.keyCode === 88) {\n          this.cut();\n          evt.returnValue = false\n        }\n        // ctrl + v\n        if (evt.keyCode === 86) {\n          this.paste();\n          evt.returnValue = false\n        }\n      }\n    });\n  }\n\n  setValueWithText (v: Cell) {\n    // console.log('setValueWithText: v = ', v)\n    if (this.currentIndexs) {\n      this.ss.cellText(v.text, (rindex, cindex, cell) => {\n        this.td(rindex, cindex).html(this.renderCell(cell))\n      })\n    }\n    this.editor.setValue(v)\n  }\n\n  setTdWithCell (rindex: number, cindex: number, cell: Cell, autoWordWrap = true) {\n    this.setTdStyles(rindex, cindex, cell);\n    this.setRowHeight(rindex, cindex, autoWordWrap);\n    this.td(rindex, cindex).html(this.renderCell(cell));\n  }\n\n  setCellAttr (k: keyof Cell, v: any) {\n    this.ss.cellAttr(k, v, (rindex, cindex, cell) => {\n      this.setTdWithCell(rindex, cindex, cell, k === 'wordWrap' && v);\n    })\n    this.editor.setStyle(this.ss.currentCell())\n  }\n\n  undo (): boolean {\n    return this.ss.undo((rindex, cindex, cell) => {\n      // console.log('>', rindex, ',', cindex, '::', cell)\n      this.setTdStylesAndAttrsAndText(rindex, cindex, cell)\n    })\n  }\n  redo (): boolean {\n    return this.ss.redo((rindex, cindex, cell) => {\n      this.setTdStylesAndAttrsAndText(rindex, cindex, cell)\n    })\n  }\n  private setTdStylesAndAttrsAndText (rindex: number, cindex: number, cell: Cell) {\n    let td = this.td(rindex, cindex);\n    this.setTdStyles(rindex, cindex, cell);\n    this.setTdAttrs(rindex, cindex, cell);\n    td.html(this.renderCell(cell));\n  }\n\n  copy () {\n    this.ss.copy();\n    this.dashedSelector.set(this.selector);\n    this.state = 'copy';\n  }\n\n  cut () {\n    this.ss.cut();\n    this.dashedSelector.set(this.selector);\n    this.state = 'cut';\n  }\n\n  copyformat () {\n    this.ss.copy();\n    this.dashedSelector.set(this.selector);\n    this.state = 'copyformat';\n  }\n\n  paste () {\n    // console.log('state: ', this.state, this.ss.select)\n    if (this.state !== null && this.ss.select) {\n      this.ss.paste((rindex, cindex, cell) => {\n        // console.log('rindex: ', rindex, ', cindex: ', cindex);\n        let td = this.td(rindex, cindex);\n        this.setTdStyles(rindex, cindex, cell);\n        this.setTdAttrs(rindex, cindex, cell);\n        if (this.state === 'cut' || this.state === 'copy') {\n          td.html(this.renderCell(cell));\n        }\n      }, this.state, (rindex, cindex, cell) => {\n        let td = this.td(rindex, cindex);\n        this.setTdStyles(rindex, cindex, cell);\n        this.setTdAttrs(rindex, cindex, cell);\n        td.html('');\n      });\n      this.selector.reload();\n    }\n\n    if (this.state === 'copyformat') {\n      this.state = null;\n    } else if (this.state === 'cut') {\n      this.state = null;  \n    } else if (this.state === 'copy') {\n      // this.ss.paste()\n    }\n    \n    this.dashedSelector.hide();\n  }\n\n  clearformat () {\n    this.ss.clearformat((rindex, cindex, cell) => {\n      this.td(rindex, cindex)\n        .removeAttr('rowspan')\n        .removeAttr('colspan')\n        .styles({}, true)\n        .show(true);\n    })\n  }\n\n  merge () {\n    this.ss.merge((rindex, cindex, cell) => {\n      // console.log(rindex, cindex, '>>>', this.table.td(rindex, cindex))\n      this.setTdAttrs(rindex, cindex, cell).show(true)\n    }, (rindex, cindex, cell) => {\n      this.setTdAttrs(rindex, cindex, cell).show(true)\n    }, (rindex, cindex, cell) => {\n      let td = this.td(rindex, cindex)\n      !cell.invisible ? td.show(true) : td.hide()\n    })\n  }\n\n  td (rindex: number, cindex: number): Element {\n    const td = this.tds[`${rindex}_${cindex}`]\n    return td\n  }\n\n  private selectorChange () {\n    if (this.state === 'copyformat') {\n      this.paste();\n    }\n  }\n\n  private selectorChangeCopy (evt: any, arrow: 'bottom' | 'top' | 'left' | 'right', startRow: number, startCol: number, stopRow: number, stopCol: number) {\n    this.ss.batchPaste(arrow, startRow, startCol, stopRow, stopCol, evt.ctrlKey, (rindex, cindex, cell) => {\n      this.setTdStyles(rindex, cindex, cell);\n      this.setTdAttrs(rindex, cindex, cell);\n      this.td(rindex, cindex).html(this.renderCell(cell));\n    })\n  }\n\n  private renderCell (cell: Cell | null): string {\n    if (cell) {\n      return formatRenderHtml(cell.format, this._renderCell(cell))\n    }\n    return '';\n  }\n  private _renderCell (cell: Cell | null): string {\n    if (cell) {\n      let text = cell.text || '';\n      return formulaRender(text, (rindex, cindex) => this._renderCell(this.ss.getCell(rindex, cindex)))\n    }\n    return '';\n  }\n\n  private setRowHeight (rindex: number, cindex: number, autoWordWrap: boolean) {\n    // console.log('rowHeight: ', this.td(rindex, cindex).offset().height, ', autoWordWrap:', autoWordWrap)\n    // éårindexè¡çææååæ ¼ï¼è®¡ç®æå¤§é«åº¦\n    const cols = this.ss.cols()\n    const td = this.td(rindex, cindex)\n    let h = td.offset().height\n    // console.log()\n    const tdRowspan = td.attr('rowspan')\n    if (tdRowspan) {\n      for (let i = 1; i < parseInt(tdRowspan); i++) {\n        let firsttds = this.firsttds[i+'']\n        firsttds && (h -= parseInt(firsttds[0].attr('height') || 0) + 1)\n      }\n    }\n    this.changeRowHeight(rindex, h - 1);\n  }\n\n  private setTdStyles (rindex: number, cindex: number, cell: Cell): Element {\n    return this.td(rindex, cindex).styles(getStyleFromCell(cell), true)\n  }\n  private setTdAttrs (rindex: number, cindex: number, cell: Cell): Element {\n    return this.td(rindex, cindex)\n      .attr('rowspan', cell.rowspan || 1)\n      .attr('colspan', cell.colspan || 1);\n  }\n\n  private changeRowHeight (index: number, h: number) {\n    if (h <= this.ss.defaultRowHeight()) return\n    this.ss.row(index, h)\n    const firstTds = this.firsttds[index+'']\n    if (firstTds) {\n      firstTds.forEach(td => td.attr('height', h))\n    }\n    this.selector.reload()\n    this.editor.reload()\n  }\n  private changeRowResizer (index: number, distance: number) {\n    const h = this.ss.row(index).height + distance\n    this.changeRowHeight(index, h);\n  }\n  private changeColResizer (index: number, distance: number) {\n    const w = this.ss.col(index).width + distance\n    if (w <= this.ss.defaultColWidth()) return\n    this.ss.col(index, w)\n    const cols = this.cols[index+'']\n    if (cols) {\n      cols.forEach(col => col.attr('width', w))\n    }\n    this.selector.reload()\n    this.editor.reload()\n  }\n\n  private buildColGroup (lastColWidth: number): Element {\n    const cols = this.ss.cols();\n    return h('colgroup').children([\n      h('col').attr('width', '60'),\n      ...cols.map((col, index) => {\n        let c = h('col').attr('width', col.width)\n        this.cols[index+''] = this.cols[index+''] || []\n        this.cols[index+''].push(c)\n        return c; \n      }),\n      h('col').attr('width', lastColWidth)\n    ])\n  }\n\n  private buildFixedLeft (): Element {\n    const rows = this.ss.rows();\n    return h().class('spreadsheet-fixed')\n    .style('width', '60px')\n    .children([\n      h().class('spreadsheet-header').child(h('table').child(\n        h('thead').child(\n          h('tr').child(\n            h('th').child('-')\n          )\n        ),\n      )),\n      this.fixedLeftBody = \n      h().class('spreadsheet-body')\n      .style('height', `${this.bodyHeight() - 15}px`)\n      .children([\n        h('table').child(\n          h('tbody').children(\n            rows.map((row, rindex) => {\n              let firstTd = h('td').attr('height', `${row.height}`).child(`${rindex + 1}`)\n                .on('mouseover', (evt: Event) => this.rowResizer.set(evt.target, rindex));\n              this.firsttdsPush(rindex, firstTd)\n              return h('tr').child(firstTd)\n            })\n          )\n        )\n      ])\n    ])\n  }\n\n  private buildHeader (): Element {\n    const cols = this.ss.cols();\n    const thead = h('thead').child(\n      h('tr').children([\n        h('th'),\n        ...cols.map((col, index) => {\n          let th = h('th').child(col.title).on('mouseover', (evt: Event) => this.colResizer.set(evt.target, index));\n          this.ths[index + ''] = th;\n          return th;\n        }),\n        h('th')\n      ]\n    ))\n    return h().class('spreadsheet-header').children([\n      h('table').children([this.buildColGroup(15), thead])\n    ])\n  }\n\n  private buildBody () {\n    const rows = this.ss.rows();\n    const cols = this.ss.cols();\n\n    const mousedown = (rindex: number, cindex: number, evt: any) => {\n      this.selector.mousedown(evt)\n      const editorValue = this.editor.value\n      if (this.currentIndexs && this.editor.target && editorValue) {\n        // console.log(':::editorValue:', editorValue)\n        const oldCell = this.ss.cellText(editorValue.text, (_rindex, _cindex, _cell: Cell) => {\n          this.td(_rindex, _cindex).html(this.renderCell(_cell))\n        });\n        // const oldTd = this.td(this.currentIndexs[0], this.currentIndexs[1]);\n        // oldTd.html(this.renderCell(editorValue))\n        if (oldCell) {\n          // è®¾ç½®åå®¹ä¹åï¼è·åé«åº¦è®¾ç½®è¡é«\n          if (oldCell.wordWrap) {\n            this.setRowHeight(this.currentIndexs[0], this.currentIndexs[1], true)\n          }\n          // console.log('old.td.offset:', oldTd.offset().height)\n          this.editorChange(oldCell)\n        }\n      }\n      this.editor.clear()\n\n      this.currentIndexs = [rindex, cindex]\n      const cCell = this.ss.currentCell([rindex, cindex])\n      this.clickCell(rindex, cindex, cCell)\n      // console.log('>>>>>>>>><<<<')\n    }\n\n    const dblclick = (rindex: number, cindex: number) => {\n      const td = this.td(rindex, cindex)\n      this.editor.set(td.el, this.ss.currentCell())\n    }\n\n    const scrollFn = (evt: any) => {\n      this.header.el.scrollLeft = evt.target.scrollLeft\n      this.fixedLeftBody && (this.fixedLeftBody.el.scrollTop = evt.target.scrollTop)\n      // console.log('>>>>>>>>scroll...', this.header, evt.target.scrollLeft, evt.target.scrollHeight)\n    }\n\n    const tbody = h('tbody').children(rows.map((row, rindex) => {\n      let firstTd = h('td').attr('height', `${row.height}`).child(`${rindex + 1}`);\n      this.firsttdsPush(rindex, firstTd)\n      return h('tr').children([\n        firstTd,\n        ...cols.map((col, cindex) => {\n          let cell = this.ss.getCell(rindex, cindex)\n          let td = h('td')\n            .child(this.renderCell(cell))\n            .attr('type', 'cell')\n            .attr('row-index', rindex + '')\n            .attr('col-index', cindex + '')\n            .attr('rowspan', cell && cell.rowspan || 1)\n            .attr('colspan', cell && cell.colspan || 1)\n            .styles(getStyleFromCell(cell), true)\n            .on('mousedown', (evt: any) => mousedown(rindex, cindex, evt))\n            .on('dblclick', dblclick.bind(null, rindex, cindex));\n          this.tds[`${rindex}_${cindex}`] = td\n          return td;\n        }),\n        h('td')\n      ])\n    }));\n\n    return h().class('spreadsheet-body')\n      .on('scroll', scrollFn)\n      .style('height', `${this.bodyHeight()}px`)\n      .children([\n        h('table').children([this.buildColGroup(0), tbody]),\n        this.editor.el,\n        this.selector.el,\n        this.dashedSelector.el\n      ]\n    )\n  }\n\n  private firsttdsPush (index: number, el: Element) {\n    this.firsttds[`${index}`] = this.firsttds[`${index}`] || []  \n    this.firsttds[`${index}`].push(el)\n  }\n\n}","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target) {\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertInto + \" \" + options.insertAt.before);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\toptions.attrs.type = \"text/css\";\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\toptions.attrs.type = \"text/css\";\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","module.exports = __webpack_public_path__ + \"13b240062f9cf9a7f4131b86a426f140.svg\";","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","module.exports = function escape(url) {\n    if (typeof url !== 'string') {\n        return url\n    }\n    // If url is already wrapped in quotes, remove them\n    if (/^['\"].*['\"]$/.test(url)) {\n        url = url.slice(1, -1);\n    }\n    // Should url be wrapped?\n    // See https://drafts.csswg.org/css-values-3/#urls\n    if (/[\"'() \\t\\n]/.test(url)) {\n        return '\"' + url.replace(/\"/g, '\\\\\"').replace(/\\n/g, '\\\\n') + '\"'\n    }\n\n    return url\n}\n","var escape = require(\"../../node_modules/css-loader/lib/url/escape.js\");\nexports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"body {\\n  margin: 0;\\n}\\n.spreadsheet {\\n  font-size: 14px;\\n  line-height: normal;\\n  user-select: none;\\n  font-family: Roboto, Helvetica, Arial, sans-serif;\\n}\\n.spreadsheet .spreadsheet-table {\\n  position: relative;\\n}\\n.spreadsheet .spreadsheet-fixed {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  z-index: 10;\\n}\\n.spreadsheet .spreadsheet-fixed .spreadsheet-body {\\n  overflow: hidden;\\n}\\n.spreadsheet .spreadsheet-body {\\n  overflow: scroll;\\n  position: relative;\\n}\\n.spreadsheet .spreadsheet-header {\\n  overflow: hidden;\\n}\\n.spreadsheet .spreadsheet-header table,\\n.spreadsheet .spreadsheet-body table,\\n.spreadsheet .spreadsheet-fixed table {\\n  table-layout: fixed;\\n  text-align: left;\\n  width: 100%;\\n  border-collapse: separate;\\n  border-spacing: 0;\\n  color: #000;\\n}\\n.spreadsheet .spreadsheet-header table td,\\n.spreadsheet .spreadsheet-body table td,\\n.spreadsheet .spreadsheet-fixed table td,\\n.spreadsheet .spreadsheet-header table th,\\n.spreadsheet .spreadsheet-body table th,\\n.spreadsheet .spreadsheet-fixed table th {\\n  transition: background .1s ease,color .1s ease;\\n  border-bottom: 1px solid #e0e2e4;\\n  border-right: 1px solid #e0e2e4;\\n  white-space: nowrap;\\n  text-overflow: ellipsis;\\n  overflow: hidden;\\n  padding: 0 4px;\\n  line-height: 22px;\\n}\\n.spreadsheet .spreadsheet-header table td.active,\\n.spreadsheet .spreadsheet-body table td.active,\\n.spreadsheet .spreadsheet-fixed table td.active,\\n.spreadsheet .spreadsheet-header table th.active,\\n.spreadsheet .spreadsheet-body table th.active,\\n.spreadsheet .spreadsheet-fixed table th.active {\\n  background: rgba(75, 137, 255, 0.05) !important;\\n}\\n.spreadsheet .spreadsheet-header table th,\\n.spreadsheet .spreadsheet-body table th,\\n.spreadsheet .spreadsheet-fixed table th {\\n  border-top: 1px solid #e0e2e4;\\n  text-align: center;\\n}\\n.spreadsheet .spreadsheet-header table th,\\n.spreadsheet .spreadsheet-body table th,\\n.spreadsheet .spreadsheet-fixed table th,\\n.spreadsheet .spreadsheet-header table td:first-child,\\n.spreadsheet .spreadsheet-body table td:first-child,\\n.spreadsheet .spreadsheet-fixed table td:first-child {\\n  font-size: 12px;\\n  background: #f4f5f8;\\n  font-weight: normal;\\n  color: #666;\\n}\\n.spreadsheet .spreadsheet-header table td:first-child,\\n.spreadsheet .spreadsheet-body table td:first-child,\\n.spreadsheet .spreadsheet-fixed table td:first-child,\\n.spreadsheet .spreadsheet-header table th:first-child,\\n.spreadsheet .spreadsheet-body table th:first-child,\\n.spreadsheet .spreadsheet-fixed table th:first-child {\\n  border-left: 1px solid #e0e2e4;\\n  text-align: center;\\n}\\n.spreadsheet-editor {\\n  position: absolute;\\n  text-align: left;\\n  border: 2px solid #4b89ff;\\n  line-height: 0;\\n  z-index: 10;\\n}\\n.spreadsheet-editor textarea {\\n  box-sizing: content-box;\\n  border: none;\\n  padding: 0 3px;\\n  outline-width: 0;\\n  resize: none;\\n  text-align: start;\\n  overflow-y: hidden;\\n  font-family: inherit;\\n  font-size: inherit;\\n  color: inherit;\\n  white-space: normal;\\n  word-wrap: break-word;\\n  line-height: 22px;\\n}\\n.spreadsheet-autocomplete {\\n  position: absolute;\\n  background: #fff;\\n  box-shadow: 1px 2px 5px 2px rgba(51, 51, 51, 0.15);\\n  text-align: left;\\n}\\n.spreadsheet-resizer {\\n  position: absolute;\\n  z-index: 11;\\n}\\n.spreadsheet-resizer.horizontal {\\n  cursor: row-resize;\\n}\\n.spreadsheet-resizer.vertical {\\n  cursor: col-resize;\\n}\\n.spreadsheet-resizer-line {\\n  position: absolute;\\n  z-index: 100;\\n}\\n.spreadsheet-resizer-line.horizontal {\\n  border-bottom: 2px dashed #4b89ff;\\n}\\n.spreadsheet-resizer-line.vertical {\\n  border-right: 2px dashed #4b89ff;\\n}\\n.spreadsheet-borders {\\n  box-sizing: content-box;\\n}\\n.spreadsheet-borders.dashed {\\n  border: 2px dashed #4b89ff;\\n  position: absolute;\\n  background: rgba(75, 137, 255, 0.03);\\n}\\n.spreadsheet-borders .left-border,\\n.spreadsheet-borders .right-border,\\n.spreadsheet-borders .bottom-border,\\n.spreadsheet-borders .top-border,\\n.spreadsheet-borders .area-border {\\n  position: absolute;\\n  font-size: 0;\\n  pointer-events: none;\\n  background: #4b89ff;\\n}\\n.spreadsheet-borders .area-border {\\n  background: rgba(75, 137, 255, 0.03);\\n}\\n.spreadsheet-borders .corner {\\n  cursor: crosshair;\\n  font-size: 0;\\n  height: 5px;\\n  width: 5px;\\n  border: 2px solid #ffffff;\\n  position: absolute;\\n  bottom: -6px;\\n  right: -6px;\\n  background: #4b89ff;\\n}\\n.spreadsheet-borders .copy-border {\\n  position: absolute;\\n  pointer-events: none;\\n  border: 1px dashed #4b89ff;\\n  background: rgba(75, 137, 255, 0.03);\\n}\\n.spreadsheet-paint-border {\\n  position: absolute;\\n  pointer-events: none;\\n  border: 1px dashed #4b89ff;\\n  background: rgba(75, 137, 255, 0.03);\\n}\\n.spreadsheet-bars .spreadsheet-toolbar {\\n  height: 40px;\\n  text-align: left;\\n  padding: 0 60px;\\n  border-bottom: 1px solid #e0e2e4;\\n  background: #f5f6f7;\\n}\\n.spreadsheet-bars .spreadsheet-toolbar > .spreadsheet-menu > .spreadsheet-item {\\n  margin: 7px 1px 0;\\n}\\n.spreadsheet-bars .spreadsheet-editor-bar {\\n  width: 100%;\\n  height: 26px;\\n  line-height: 26px;\\n  position: relative;\\n  background: #fff;\\n  padding: 0;\\n}\\n.spreadsheet-formula-bar {\\n  position: relative;\\n  height: 100%;\\n}\\n.spreadsheet-formula-bar .spreadsheet-formula-label {\\n  width: 60px;\\n  height: 100%;\\n  box-sizing: border-box;\\n  display: inline-block;\\n  text-align: center;\\n  border-right: 1px solid #e0e2e4;\\n  background-color: #fff;\\n  font-size: 12px;\\n  color: #777;\\n  user-select: none;\\n  float: left;\\n  vertical-align: middle;\\n}\\n.spreadsheet-formula-bar textarea {\\n  width: calc(100% - 60px);\\n  height: 100%;\\n  box-sizing: border-box;\\n  font-family: inherit;\\n  font-size: inherit;\\n  padding: 4px 10px;\\n  position: relative;\\n  float: left;\\n  resize: none;\\n  overflow-y: hidden;\\n  border: none;\\n  outline-width: 0;\\n}\\n.spreadsheet-formula-bar-resizer {\\n  cursor: ns-resize;\\n  height: 4px;\\n  position: absolute;\\n  width: 100%;\\n  left: 0;\\n  bottom: 0;\\n}\\n.spreadsheet-menu.vertical > .spreadsheet-item-separator {\\n  background: #e0e2e4;\\n  height: 1px;\\n  margin: 5px 0;\\n}\\n.spreadsheet-menu.vertical > .spreadsheet-item {\\n  padding: 2px 10px;\\n  border-radius: 0;\\n}\\n.spreadsheet-menu.horizontal > .spreadsheet-item {\\n  display: inline-block;\\n}\\n.spreadsheet-menu.horizontal > .spreadsheet-item-separator {\\n  display: inline-block;\\n  background: #e0e2e4;\\n  width: 1px;\\n  vertical-align: middle;\\n  height: 18px;\\n  margin: 0 3px;\\n}\\n.spreadsheet-menu > .spreadsheet-item {\\n  border-radius: 2px;\\n  user-select: none;\\n  background: 0;\\n  border: 1px solid transparent;\\n  outline: none;\\n  height: 24px;\\n  color: rgba(0, 0, 0, 0.8);\\n  line-height: 24px;\\n  list-style: none;\\n  cursor: default;\\n}\\n.spreadsheet-menu > .spreadsheet-item.disabled {\\n  pointer-events: none;\\n  opacity: 0.5;\\n}\\n.spreadsheet-menu > .spreadsheet-item:not(.separator):hover,\\n.spreadsheet-menu > .spreadsheet-item.active {\\n  background: rgba(0, 0, 0, 0.08);\\n}\\n.spreadsheet-menu > .spreadsheet-item:not(.separator):hover .spreadsheet-icon-img,\\n.spreadsheet-menu > .spreadsheet-item.active .spreadsheet-icon-img {\\n  opacity: 0.7;\\n}\\n.spreadsheet-menu > .spreadsheet-item:not(.separator):hover .spreadsheet-dropdown-icon,\\n.spreadsheet-menu > .spreadsheet-item.active .spreadsheet-dropdown-icon {\\n  background-color: rgba(0, 0, 0, 0.15);\\n  opacity: 0.6;\\n}\\n.spreadsheet-menu > .spreadsheet-item > .label {\\n  float: right;\\n  opacity: .8;\\n}\\n.spreadsheet-dropdown {\\n  position: relative;\\n  display: inline-block;\\n  width: auto!important;\\n}\\n.spreadsheet-dropdown .spreadsheet-dropdown-content {\\n  position: absolute;\\n  top: calc(100% + 5px);\\n  left: 0;\\n  z-index: 200;\\n  background: #fff;\\n  box-shadow: 1px 2px 5px 2px rgba(51, 51, 51, 0.15);\\n  width: auto;\\n}\\n.spreadsheet-dropdown .spreadsheet-dropdown-header .spreadsheet-dropdown-title {\\n  padding: 0 5px;\\n  display: inline-block;\\n}\\n.spreadsheet-dropdown .spreadsheet-dropdown-header .spreadsheet-dropdown-icon {\\n  display: inline-block;\\n  vertical-align: top;\\n}\\n.spreadsheet-dropdown .spreadsheet-dropdown-header .spreadsheet-dropdown-icon .spreadsheet-icon {\\n  width: 10px;\\n}\\n.spreadsheet-dropdown .spreadsheet-dropdown-header .spreadsheet-dropdown-icon .spreadsheet-icon .arrow-down {\\n  left: -130px;\\n}\\n.spreadsheet-color-panel {\\n  padding: 10px;\\n  width: 100%;\\n}\\n.spreadsheet-color-panel table {\\n  border-collapse: separate;\\n  border-spacing: 0;\\n  border: none;\\n}\\n.spreadsheet-color-panel table tr td {\\n  padding: 0;\\n  border: none;\\n}\\n.spreadsheet-color-panel .color-cell {\\n  width: 20px;\\n  height: 20px;\\n  margin: 3px;\\n}\\n.spreadsheet-color-panel .color-cell:hover {\\n  box-shadow: 0 0 2px rgba(0, 0, 0, 0.8);\\n}\\n.spreadsheet-icon {\\n  height: 18px;\\n  width: 18px;\\n  margin: 0px 4px 3px 3px;\\n  direction: ltr;\\n  text-align: left;\\n  user-select: none;\\n  vertical-align: middle;\\n  overflow: hidden;\\n  position: relative;\\n  display: inline-block;\\n}\\n.spreadsheet-icon-img {\\n  background-image: url(\" + escape(require(\"../assets/sprite.svg\")) + \");\\n  position: absolute;\\n  width: 262px;\\n  height: 444px;\\n  opacity: 0.55;\\n}\\n.spreadsheet-icon-img.undo {\\n  left: 0;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.redo {\\n  left: -18px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.print {\\n  left: -36px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.paintformat {\\n  left: -54px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.clearformat {\\n  left: -72px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.bold {\\n  left: -90px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.italic {\\n  left: -108px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.underline {\\n  left: -126px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.strikethrough {\\n  left: -144px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.text-color {\\n  left: -162px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.cell-color {\\n  left: -180px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.merge {\\n  left: -198px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.align-left {\\n  left: -216px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.align-center {\\n  left: -234px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.align-right {\\n  left: 0;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.valign-top {\\n  left: -18px;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.valign-middle {\\n  left: -36px;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.valign-bottom {\\n  left: -54px;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.textwrap {\\n  left: -72px;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.autofilter {\\n  left: -90px;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.formula {\\n  left: -108px;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.arrow-down {\\n  left: -126px;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.arrow-right {\\n  left: -144px;\\n  top: -18px;\\n}\\n\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./index.less\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./index.less\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./index.less\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","export class Select {\n  constructor(public start: [number, number], public stop: [number, number], public canMerge: boolean) {}\n  forEach (cb: (r:number, c: number, rindex: number, cindex: number, rowspan: number, colspan: number) => void): void {\n    const [sx, sy] = this.start\n    const [ex, ey] = this.stop\n    for (let i = sx; i <= ex; i++) {\n      for (let j = sy; j <= ey; j++) {\n        cb(i, j, i - sx, j - sy, ex - sx + 1, ey - sy + 1)\n      }\n    }\n  }\n  rowIndex (index: number) {\n    return this.start[0] + index % this.rowLen()\n  }\n  colIndex (index: number) {\n    return this.start[1] + index % this.colLen()\n  }\n  rowLen () {\n    return this.stop[0] - this.start[0] + 1\n  }\n  colLen () {\n    return this.stop[1] - this.start[1] + 1\n  }\n  cellLen () {\n    return this.rowLen() * this.colLen()\n  }\n}\n\n// export function buildSelect (start: any, end: )","export interface Font {\n  key: string;\n  title: string;\n}\n\nexport const fonts: Array<Font> = [\n  {key: 'Microsoft YaHei', title: 'å¾®è½¯éé»'},\n  {key: 'STFangsong', title: 'åæä»¿å®'},\n  {key: 'Comic Sans MS', title: 'Comic Sans MS'},\n  {key: 'Arial', title: 'Arial'},\n  {key: 'Courier New', title: 'Courier New'},\n  {key: 'Verdana', title: 'Verdana'}\n]","import { Format, formats } from './format'\nimport { Font, fonts } from './font'\nimport { Formula, formulas, formulaReplaceParam } from './formula'\nimport { Cell, defaultCell } from './cell'\nimport { alphabet } from './alphabet'\nimport { Select } from './select'\n\ninterface Row {\n  height: number\n}\ninterface Col {\n  title: string\n  width: number\n}\ninterface Map<T> {\n  [key: number]: T\n}\ninterface MapS<T> {\n  [key: string]: T\n}\nclass History {\n  values: Array<[Array<any>, any, any]> = [];\n  constructor (public type: 'rows' | 'cols' | 'cells') {}\n  add (keys: Array<any>, value: any, oldValue: any) {\n    this.values.push([keys, value, oldValue])\n  }\n}\n// types\ntype StandardCallback = (rindex: number, cindex: number, cell: Cell) => void;\n\nexport interface SpreadsheetData {\n  rowHeight?: number;\n  colWidth?: number;\n  rows?: Map<Row>;\n  cols?: Map<Col>;\n  cell: Cell; // global default cell\n  cells?: Map<Map<Cell>>;\n  [prop: string]: any\n}\n\nexport interface SpreadsheetOptions {\n  formats?: Array<Format>;\n  fonts?: Array<Font>;\n  formulas?: Array<Formula>;\n  data?: SpreadsheetData;\n}\n\nexport class Spreadsheet {\n  formats: Array<Format>;\n  fonts: Array<Font>;\n  formulas: Array<Formula>;\n  data: SpreadsheetData;\n  private histories: Array<History> = [];\n  private histories2: Array<History> = [];\n  private currentCellIndexes: [number, number] = [0, 0];\n  select: Select | null = null;\n  private copySelect: Select | null = null;\n  private cutSelect: Select | null = null;\n\n  change: (data: SpreadsheetData) => void = () => {}\n\n  constructor (options: SpreadsheetOptions = {}) {\n    this.formats = options.formats || formats\n    this.fonts = options.fonts || fonts\n    this.formulas = options.formulas || formulas\n    // init data\n    this.data = {rowHeight: 22, colWidth: 100, cell: defaultCell}\n    if (options.data) {\n      const { data } = options;\n      for (let prop of ['rowHeight', 'colWidth', 'rows', 'cols', 'cells']) {\n        if (data[prop]) {\n          this.data[prop] = data[prop];\n        }\n      }\n      (<any>Object).assign(this.data.cell, data.cell || {});\n    }\n  }\n\n  // build select\n  buildSelect (startTarget: any, endTarget: any) {\n    const startAttrs = getElementAttrs(startTarget)\n    const endAttrs = getElementAttrs(endTarget)\n    // console.log(':::::::>>>', startAttrs, endAttrs)\n    let sRow = startAttrs.row\n    let sCol = startAttrs.col\n    let eRow = endAttrs.row\n    let eCol = endAttrs.col\n    if (sRow > eRow) {\n      sRow = endAttrs.row\n      eRow = startAttrs.row\n    }\n    if (sCol > eCol) {\n      sCol = endAttrs.col\n      eCol = startAttrs.col\n    }\n    // calc min, max of row\n    // console.log('s: ', sRow, sCol, ', e: ', eRow, eCol)\n    let [minRow, maxRow] = calcMinï¼­axRow((r: number, c: number) => this.getCell(r, c), sRow, eRow, sCol, eCol)\n    // console.log('minRow: ', minRow, ', maxRow: ', maxRow)\n    // calc min, max of col\n    let [minCol, maxCol] = calcMinMaxCol((r: number, c: number) => this.getCell(r, c), minRow, maxRow, sCol, eCol)\n    while (true) {\n      const [minr, maxr] = calcMinï¼­axRow((r: number, c: number) => this.getCell(r, c), minRow, maxRow, minCol, maxCol)\n      let [minc, maxc] = calcMinMaxCol((r: number, c: number) => this.getCell(r, c), minRow, maxRow, minCol, maxCol)\n      if (minRow === minr && maxRow === maxr && minCol === minc && maxCol === maxc) {\n        break\n      }\n      minRow = minr\n      maxRow = maxr\n      minCol = minc\n      maxCol = maxc\n    }\n    const firstCell = this.getCell(minRow, minCol)\n    // console.log('first => rowspan: ', firstCell.rowspan, ', colspan: ', firstCell.colspan)\n    let canotMerge = minRow + (firstCell && firstCell.rowspan || 1) - 1 === maxRow && minCol + (firstCell && firstCell.colspan || 1) - 1 === maxCol\n    // console.log('row: ', minRow, maxRow, ', col:', minCol, maxCol, canotMerge)\n    // è®¡ç®æ¯å¦å¯ä»¥merge\n    this.select = new Select([minRow, minCol], [maxRow, maxCol], !canotMerge)\n    return this.select\n  }\n\n  defaultRowHeight (): number {\n    return this.data.rowHeight || 22\n  }\n\n  defaultColWidth (): number {\n    return this.data.colWidth || 100\n  }\n\n  copy (): void {\n    this.copySelect = this.select\n  }\n  cut (): void {\n    this.cutSelect = this.select\n  }\n  paste (cb: StandardCallback, state: 'copy' | 'cut' | 'copyformat', clear: StandardCallback): void {\n    let cselect = this.copySelect\n    if (this.cutSelect) {\n      cselect = this.cutSelect\n      this.cutSelect = null\n    }\n    if (cselect && this.select) {\n      const history = new History('cells')\n      if (state === 'copyformat') {\n        this.select.forEach((rindex, cindex, i, j, rowspan, colspan) => {\n          if (cselect) {\n            const srcRowIndex = cselect.rowIndex(i)\n            const srcColIndex = cselect.colIndex(j)\n            const [oldCell, newCell] = this.copyCell(srcRowIndex, srcColIndex, rindex, cindex, state, cb, clear)\n            history.add([rindex, cindex], oldCell, newCell)\n          }\n        })\n      } else {\n        cselect.forEach((rindex, cindex, i, j, rowspan, colspan) => {\n          if (this.select) {\n            const destRowIndex = this.select.start[0] + i\n            const destColIndex = this.select.start[1] + j\n            const [oldCell, newCell] = this.copyCell(rindex, cindex, destRowIndex, destColIndex, state, cb, clear)\n            history.add([destRowIndex, destColIndex], oldCell, newCell)\n          }\n        })\n      }\n      this.histories.push(history)\n      this.change(this.data)\n    }\n  }\n  batchPaste (arrow: 'bottom' | 'top' | 'left' | 'right',\n    startRow: number, startCol: number, stopRow: number, stopCol: number,\n    seqCopy: boolean,\n    cb: StandardCallback) {\n    if (this.select) {\n      const history = new History('cells')\n      for (let i = startRow; i <= stopRow; i++) {\n        for (let j = startCol; j <= stopCol; j++) {\n          const srcRowIndex = this.select.rowIndex(i - startRow)\n          const srcColIndex = this.select.colIndex(j - startCol)\n          const [oldDestCell, destCell] = this.copyCell(srcRowIndex, srcColIndex, i, j, seqCopy ? 'seqCopy' : 'copy', cb, () => {})\n          history.add([i, j], oldDestCell, destCell)\n        }\n      }\n      this.histories.push(history)\n      this.change(this.data)\n    }\n  }\n  private copyCell (srcRowIndex: number, srcColIndex: number, destRowIndex: number, destColIndex: number,\n    state: 'seqCopy' | 'copy' | 'cut' | 'copyformat', cb: StandardCallback, clear: StandardCallback): [Cell | null, Cell | null] {\n    const srcCell = this.getCell(srcRowIndex, srcColIndex)\n    const rowDiff = destRowIndex - srcRowIndex\n    const colDiff = destColIndex - srcColIndex\n    if (srcCell) {\n      let oldDestCell = this.getCell(destRowIndex, destColIndex)\n      // let destCell = cellCopy(srcCell, destRowIndex - srcRowIndex, destColIndex - srcColIndex, state === 'seqCopy')\n      const destCell = Object.assign({}, srcCell)\n      if (srcCell.merge) {\n        const [m1, m2] = srcCell.merge\n        destCell.merge = [m1 + rowDiff, m2 + colDiff];\n      }\n      \n\n      if (state === 'cut') {\n        clear(srcRowIndex, srcColIndex, this.cell(srcRowIndex, srcColIndex, {}))\n      }\n      if (state === 'copyformat') {\n        if (oldDestCell && oldDestCell.text) {\n          destCell.text = oldDestCell.text\n        }\n      } else {\n        const txt = destCell.text\n        if (txt && !/^\\s*$/.test(txt)) {\n          if (/^\\d*$/.test(txt) && state === 'seqCopy') {\n            destCell.text = (parseInt(txt) + (destRowIndex - srcRowIndex) + (destColIndex - srcColIndex)) + ''\n          } else if (txt.indexOf('=') !== -1) {\n            // å¦ætextçåå®¹æ¯formula,é£ä¹éè¦éè¦ä¿®æ¹è¡¨è¾¾å¼åæ°\n            destCell.text = formulaReplaceParam(txt, rowDiff, colDiff)\n          }\n        }\n      }\n\n      cb(destRowIndex, destColIndex, this.cell(destRowIndex, destColIndex, destCell))\n      return [oldDestCell, destCell];\n    }\n    return [null, null];\n  }\n\n  isRedo (): boolean {\n    return this.histories2.length > 0\n  }\n  redo (cb: StandardCallback): boolean {\n    const { histories, histories2 } = this\n    if (histories2.length > 0) {\n      const history = histories2.pop()\n      if (history) {\n        this.resetByHistory(history, cb, 'redo')\n        histories.push(history)\n        this.change(this.data)\n      }\n    }\n    return this.isRedo()\n  }\n\n  isUndo (): boolean {\n    return this.histories.length > 0\n  }\n  undo (cb: StandardCallback): boolean {\n    const { histories, histories2 } = this\n    // console.log('histories:', histories, histories2)\n    if (histories.length > 0) {\n      const history = histories.pop()\n      if (history) {\n        this.resetByHistory(history, cb, 'undo')\n        histories2.push(history)\n        this.change(this.data)\n      }\n    }\n    return this.isUndo()\n  }\n\n  resetByHistory (v: History, cb: StandardCallback, state: 'undo' | 'redo') {\n    // console.log('history: ', history)\n    v.values.forEach(([keys, oldValue, value]) => {\n      if (v.type === 'cells') {\n        const v = state === 'undo' ? oldValue : value\n        const oldCell = this.getCell(keys[0], keys[1])\n        if (oldCell === null) {\n          if (keys.length === 3) {\n            if (v !== undefined) {\n              const nValue: Cell = {}\n              nValue[keys[2]] = v\n              cb(keys[0], keys[1], this.cell(keys[0], keys[1], nValue))\n            }\n          } else {\n            if (v !== undefined) {\n              cb(keys[0], keys[1], this.cell(keys[0], keys[1], v))\n            }\n          }\n        } else {\n          if (keys.length === 3) {\n            const nValue: Cell = {}\n            nValue[keys[2]] = v\n            if (v !== undefined) {\n              cb(keys[0], keys[1], this.cell(keys[0], keys[1], nValue, true))\n            } else {\n              cb(keys[0], keys[1], this.cell(keys[0], keys[1], mapFilter(oldCell, keys[2])))\n            }\n          } else {\n            cb(keys[0], keys[1], this.cell(keys[0], keys[1], v || {}))\n          }\n        }\n      }\n      // console.log('keys:', keys, ', oldValue:', oldValue, ', value:', value)\n    })\n  }\n\n  clearformat (cb: StandardCallback) {\n    const { select } = this\n    if (select !== null) {\n      const history = new History('cells')\n      select.forEach((rindex, cindex, i, j, rowspan, colspan) => {\n        let c = this.getCell(rindex, cindex);\n        if (c) {\n          history.add([rindex, cindex], c, {text: c.text})\n          c = this.cell(rindex, cindex, {text: c.text});\n          cb(rindex, cindex, c);\n        }\n      });\n      this.histories.push(history)\n      this.change(this.data)\n    }\n  }\n\n  /**\n   * \n   * @param ok åå¹¶ååæ ¼ç¬¬ä¸ä¸ªååæ ¼ï¼å·¦ä¸è§ï¼çåè°å½æ°\n   * @param cancel åæ¶åå¹¶ååæ ¼ç¬¬ä¸ä¸ªååæ ¼ï¼å·¦ä¸è§ï¼çåè°å½æ°\n   * @param other å¶ä»ååæ ¼çåè°å½æ°\n   */\n  merge (ok: StandardCallback, cancel: StandardCallback, other: StandardCallback): void {\n    const { select } = this\n    // console.log('data.before: ', this.data)\n    if (select !== null && select.cellLen() > 1) {\n      // merge merge: [rows[0], cols[0]]\n      const history = new History('cells')\n      let index = 0\n      let firstXY: [number, number] = [0, 0]\n      select.forEach((rindex, cindex, i, j, rowspan, colspan) => {\n        if (index++ === 0) {\n          firstXY = [rindex, cindex]\n          let v: Cell = {}\n          if (rowspan > 1) v.rowspan = rowspan\n          if (colspan > 1) v.colspan = colspan\n          // console.log('rowspan:', rowspan, ', colspan:', colspan, select.canMerge)\n          if (select.canMerge) {\n            history.add([rindex, cindex, 'rowspan'], undefined, rowspan)\n            history.add([rindex, cindex, 'colspan'], undefined, colspan)\n\n            let cell = this.cell(rindex, cindex, v, true)\n            ok(rindex, cindex, cell)\n          } else {\n            const oldCell = this.getCell(rindex, cindex)\n            if (oldCell !== null) {\n              history.add([rindex, cindex, 'rowspan'], oldCell.rowspan, undefined)\n              history.add([rindex, cindex, 'colspan'], oldCell.colspan, undefined)\n\n              let cell = this.cell(rindex, cindex, mapFilter(oldCell, 'rowspan', 'colspan', 'merge'))\n              cancel(rindex, cindex, cell)\n            }\n          }\n        } else {\n          let v: Cell = {invisible: select.canMerge}\n          if (select.canMerge) {\n            history.add([rindex, cindex, 'invisible'], undefined, select.canMerge)\n\n            v.merge = firstXY\n            let cell = this.cell(rindex, cindex, v, true)\n            other(rindex, cindex, cell)\n          } else {\n            const oldCell = this.getCell(rindex, cindex)\n            if (oldCell !== null) {\n              history.add([rindex, cindex, 'invisible'], oldCell.invisible, undefined)\n              let cell = this.cell(rindex, cindex, mapFilter(oldCell, 'rowspan', 'colspan', 'merge', 'invisible'))\n              other(rindex, cindex, cell)\n            }\n          }\n        }\n      })\n      this.histories.push(history)\n      select.canMerge = !select.canMerge\n      this.change(this.data)\n    }\n  }\n  cellAttr (key: keyof Cell, value: any, cb: StandardCallback): void {\n    let v: Cell= {}\n    v[key] = value\n    const isDefault = value === this.data.cell[key]\n    if (this.select !== null) {\n      const history = new History('cells')\n      this.select.forEach((rindex, cindex) => {\n        const oldCell = this.getCell(rindex, cindex)\n        \n        history.add([rindex, cindex, key], oldCell !== null ? oldCell[key] : undefined, value)\n        let cell = this.cell(rindex, cindex, isDefault ? mapFilter(oldCell, key) : v, !isDefault)\n        cb(rindex, cindex, cell)\n      \n      })\n      this.histories.push(history)\n    }\n    this.change(this.data)\n  }\n  cellText (value: any, cb: StandardCallback): Cell | null {\n    if (this.currentCellIndexes) {\n      // this.addHistoryValues()\n      const history = new History('cells')\n      const [rindex, cindex] = this.currentCellIndexes\n      const oldCell = this.getCell(rindex, cindex)\n      history.add([rindex, cindex, 'text'], oldCell !== null ? oldCell.text : undefined, value)\n      const cell = this.cell(rindex, cindex, {text: value}, true)\n      cb(rindex, cindex, cell)\n\n      this.histories.push(history)\n      this.change(this.data)\n      return cell;\n    }\n    return null\n  }\n  currentCell (indexes?: [number, number]): Cell | null {\n    if (indexes !== undefined) {\n      this.currentCellIndexes = indexes\n    }\n    const [rindex, cindex] = this.currentCellIndexes\n    return this.getCell(rindex, cindex)\n  }\n\n  cell (rindex: number, cindex: number, v: any, isCopy = false): Cell {\n    this.data.cells = this.data.cells || {}\n    this.data.cells[rindex] = this.data.cells[rindex] || {}\n    this.data.cells[rindex][cindex] = this.data.cells[rindex][cindex] || {}\n    if (isCopy) {\n      (<any>Object).assign(this.data.cells[rindex][cindex], v)\n    } else if (v) {\n      this.data.cells[rindex][cindex] = v\n    }\n    return this.data.cells[rindex][cindex]\n  }\n\n  getCell (rindex: number, cindex: number): Cell | null {\n    if (this.data.cells && this.data.cells[rindex] && this.data.cells[rindex][cindex]) {\n      return this.data.cells[rindex][cindex];\n    }\n    return null;\n  }\n\n  getFont (key: string | undefined) {\n    return this.fonts.filter(it => it.key === key)[0]\n  }\n  getFormat (key: string | undefined) {\n    return this.formats.filter(it => it.key === key)[0]\n  }\n\n  row (index: number, v?: number): Row {\n    const { data } = this;\n    if (v !== undefined) {\n      data.rows = data.rows || {}\n      data.rows[index] = data.rows[index] || {}\n      data.rows[index].height = v\n    }\n    return (<any>Object).assign({height: data.rowHeight}, data.rows ? data.rows[index] : {})\n  }\n  rows (): Array<Row> {\n    const { data } = this;\n    let maxRow = mapMaxKey(100, data.rows);\n    return range(maxRow, (index) => this.row(index))\n  }\n\n  col (index: number, v?: number): Col {\n    const { data } = this;\n    if (v !== undefined) {\n      data.cols = data.cols || {}\n      data.cols[index] = data.cols[index] || {}\n      data.cols[index].width = v\n    }\n    return (<any>Object).assign({width: data.colWidth, title: alphabet(index)}, data.cols ? data.cols[index] : {})\n  }\n  cols (): Array<Col> {\n    const { data } = this;\n    let maxCol = mapMaxKey(26, data.cols);\n    return range(maxCol, (index) => this.col(index));\n  }\n}\n\n// methods\nconst mapMaxKey = function<T>(max: number, map: Map<T> | undefined): number {\n  if (map) {\n    const m = Math.max(...Object.keys(map).map(s => parseInt(s)))\n    if (m > max) return m;\n  }\n  return max;\n}\nconst mapFilter = function(obj: any, ...keys: Array<string>): any {\n  const ret: any = {}\n  if (obj){\n    Object.keys(obj).forEach(e => {\n      if (keys.indexOf(e) === -1) {\n        ret[e] = obj[e]\n      }\n    })\n  }\n  return ret\n}\nconst range = function<T>(stop:number, cb: (index: number) => T): Array<T> {\n  const ret = []\n  for (let i = 0; i < stop; i++) {\n    ret.push(cb(i))\n  }\n  return ret\n}\nconst getElementAttrs = (target: any) => {\n  const { offsetTop, offsetLeft, offsetHeight, offsetWidth } = target\n  return {\n    row: parseInt(target.getAttribute('row-index')),\n    col: parseInt(target.getAttribute('col-index')),\n    rowspan: parseInt(target.getAttribute('rowspan')),\n    colspan: parseInt(target.getAttribute('colspan')),\n    left: offsetLeft,\n    top: offsetTop,\n    width: offsetWidth,\n    height: offsetHeight\n  }\n}\nconst calcMinMaxCol = (cell: any, sRow: number, eRow: number, sCol: number, eCol: number) => {\n  let minCol = sCol\n  let maxCol = eCol\n  // console.log(':::::::;start: ', maxCol, minCol)\n  for (let j = sRow; j <= eRow; j++) {\n    let cCol = sCol\n    let dcell = cell(j, cCol)\n    if (dcell && dcell.merge) {\n      cCol += dcell.merge[1] - cCol\n    }\n    if (cCol < minCol) minCol = cCol\n\n    cCol = maxCol\n    dcell = cell(j, cCol)\n    // console.log(j, cCol, dcell && dcell.colspan || 1)\n    const cColspan = dcell ? dcell.colspan : 1\n    if (parseInt(cColspan) > 1) {\n      cCol += parseInt(cColspan)\n    } else {\n      if (dcell && dcell.merge) {\n        // console.log('merge::', maxCol, dcell.merge)\n        const [r, c] = dcell.merge\n        const rc = cell(r, c).colspan\n        cCol += rc + (c - cCol)\n      }\n    }\n    // console.log('cCol: ', cCol, ', maxCol: ', maxCol)\n    // console.log(':::::::;end: ', maxCol, minCol)\n    if (cCol - 1 > maxCol) maxCol = cCol - 1\n  }\n  return [minCol, maxCol]\n}\nconst calcMinï¼­axRow = (cell: any, sRow: number, eRow: number, sCol: number, eCol: number) => {\n  let minRow = sRow\n  let maxRow = eRow\n  for (let j = sCol; j <= eCol; j++) {\n    let cRow = sRow\n    let dcell = cell(cRow, j)\n    if (dcell && dcell.merge) {\n      cRow += dcell.merge[0] - cRow\n    }\n    if (cRow < minRow) minRow = cRow\n\n    cRow = maxRow\n    dcell = cell(cRow, j)\n    // console.log('row: ', j, cRow, dcell.rowspan)\n    const cRowspan = dcell ? dcell.rowspan : 1\n    if (parseInt(cRowspan) > 1) {\n      cRow += parseInt(cRowspan)\n    } else {\n      if (dcell && dcell.merge) {\n        const [r, c] = dcell.merge\n        const rs = cell(r, c).rowspan\n        cRow += rs + (r - cRow)\n      }\n    }\n    if (cRow - 1 > maxRow) maxRow = cRow - 1\n  }\n  return [minRow, maxRow]\n}","import { Spreadsheet, SpreadsheetOptions, SpreadsheetData } from '../core/index'\nimport '../style/index.less'\nimport { Cell, getStyleFromCell } from '../core/cell';\nimport { Format } from '../core/format';\nimport { Font } from '../core/font';\nimport { Editor } from './editor';\nimport { Selector } from './selector';\nimport { Table } from './table';\nimport { Toolbar } from './toolbar';\nimport { Editorbar } from './editorbar';\nimport { h, Element } from './base/element'\n\nexport interface Options {\n  d?: SpreadsheetOptions;\n  bodyHeight?: () => number;\n}\n\nexport class LocalSpreadsheet {\n  ss: Spreadsheet;\n  refs: {[key: string]: HTMLElement} = {};\n  table: Table;\n  toolbar: Toolbar;\n  editorbar: Editorbar;\n\n  change: (data: SpreadsheetData) => void = () => {}\n\n  constructor (public el: HTMLElement, options: Options = {}) {\n    this.ss = new Spreadsheet(options.d || {});\n    // console.log('::::>>>select:', this.ss.select)\n    this.editorbar = new Editorbar()\n    this.editorbar.change = (v) => this.editorbarChange(v)\n\n    this.toolbar = new Toolbar(this.ss);\n    this.toolbar.change = (key, v) => this.toolbarChange(key, v)\n    this.toolbar.undo = () => {\n      // console.log('undo::')\n      return this.table.undo()\n    }\n    this.toolbar.redo = () => {\n      // console.log('redo::')\n      return this.table.redo()\n    }\n\n    this.table = new Table(this.ss, options.bodyHeight);\n    this.table.change = (data) => {\n      this.toolbar.setRedoAble(this.ss.isRedo())\n      this.toolbar.setUndoAble(this.ss.isUndo())\n      this.change(data)\n    }\n    this.table.editorChange = (v) => this.editorChange(v)\n    this.table.clickCell = (rindex, cindex, cell) => this.clickCell(rindex, cindex, cell)\n    this.render();\n  }\n\n  private render (): void {\n    this.el.appendChild(h().class('spreadsheet').children([\n      h().class('spreadsheet-bars').children([\n        this.toolbar.el,\n        this.editorbar.el,\n      ]),\n      this.table.el\n    ]).el);\n  }\n\n  private toolbarChange (k: keyof Cell, v: any) {\n    if (k === 'merge') {\n      this.table.merge();\n      return;\n    } else if (k === 'clearformat') {\n      this.table.clearformat();\n      return ;\n    } else if (k === 'paintformat') {\n      this.table.copyformat();\n      return ;\n    }\n\n    this.table.setCellAttr(k, v);\n  }\n\n  private editorbarChange (v: Cell) {\n    this.table.setValueWithText(v)\n  }\n\n  private editorChange (v: Cell) {\n    this.editorbar.setValue(v)\n  }\n\n  private clickCell (rindex: number, cindex: number, v: Cell | null) {\n    const cols = this.ss.cols()\n    this.editorbar.set(`${cols[cindex].title}${rindex + 1}`, v)\n    this.toolbar.set(this.table.td(rindex, cindex), v)\n  }\n\n}\n","import { LocalSpreadsheet, Options } from './local/index';\n\nexport default function xspreadsheet (el: HTMLElement, options?: Options) {\n  return new LocalSpreadsheet(el, options)\n}\n\ndeclare global {\n  interface Window {\n    xspreadsheet: any;\n  }\n}\n\nwindow.xspreadsheet = xspreadsheet\n"],"sourceRoot":""}